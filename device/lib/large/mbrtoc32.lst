                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module mbrtoc32
                                      6 	.optsdcc -mmcs51 --model-large
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _mbrtowc
                                     12 	.globl _mbrtoc32_PARM_4
                                     13 	.globl _mbrtoc32_PARM_3
                                     14 	.globl _mbrtoc32_PARM_2
                                     15 	.globl _mbrtoc32
                                     16 ;--------------------------------------------------------
                                     17 ; special function registers
                                     18 ;--------------------------------------------------------
                                     19 	.area RSEG    (ABS,DATA)
      000000                         20 	.org 0x0000
                                     21 ;--------------------------------------------------------
                                     22 ; special function bits
                                     23 ;--------------------------------------------------------
                                     24 	.area RSEG    (ABS,DATA)
      000000                         25 	.org 0x0000
                                     26 ;--------------------------------------------------------
                                     27 ; overlayable register banks
                                     28 ;--------------------------------------------------------
                                     29 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         30 	.ds 8
                                     31 ;--------------------------------------------------------
                                     32 ; internal ram data
                                     33 ;--------------------------------------------------------
                                     34 	.area DSEG    (DATA)
      000000                         35 _mbrtoc32_sloc0_1_0:
      000000                         36 	.ds 2
      000002                         37 _mbrtoc32_sloc1_1_0:
      000002                         38 	.ds 3
                                     39 ;--------------------------------------------------------
                                     40 ; overlayable items in internal ram
                                     41 ;--------------------------------------------------------
                                     42 ;--------------------------------------------------------
                                     43 ; indirectly addressable internal ram data
                                     44 ;--------------------------------------------------------
                                     45 	.area ISEG    (DATA)
                                     46 ;--------------------------------------------------------
                                     47 ; absolute internal ram data
                                     48 ;--------------------------------------------------------
                                     49 	.area IABS    (ABS,DATA)
                                     50 	.area IABS    (ABS,DATA)
                                     51 ;--------------------------------------------------------
                                     52 ; bit data
                                     53 ;--------------------------------------------------------
                                     54 	.area BSEG    (BIT)
                                     55 ;--------------------------------------------------------
                                     56 ; paged external ram data
                                     57 ;--------------------------------------------------------
                                     58 	.area PSEG    (PAG,XDATA)
                                     59 ;--------------------------------------------------------
                                     60 ; uninitialized external ram data
                                     61 ;--------------------------------------------------------
                                     62 	.area XSEG    (XDATA)
      000000                         63 _mbrtoc32_PARM_2:
      000000                         64 	.ds 3
      000003                         65 _mbrtoc32_PARM_3:
      000003                         66 	.ds 2
      000005                         67 _mbrtoc32_PARM_4:
      000005                         68 	.ds 3
      000008                         69 _mbrtoc32_pc32_65536_15:
      000008                         70 	.ds 3
      00000B                         71 _mbrtoc32_wc_65536_16:
      00000B                         72 	.ds 4
      00000F                         73 _mbrtoc32_sps_65536_16:
      00000F                         74 	.ds 3
                                     75 ;--------------------------------------------------------
                                     76 ; absolute external ram data
                                     77 ;--------------------------------------------------------
                                     78 	.area XABS    (ABS,XDATA)
                                     79 ;--------------------------------------------------------
                                     80 ; initialized external ram data
                                     81 ;--------------------------------------------------------
                                     82 	.area XISEG   (XDATA)
                                     83 	.area HOME    (CODE)
                                     84 	.area GSINIT0 (CODE)
                                     85 	.area GSINIT1 (CODE)
                                     86 	.area GSINIT2 (CODE)
                                     87 	.area GSINIT3 (CODE)
                                     88 	.area GSINIT4 (CODE)
                                     89 	.area GSINIT5 (CODE)
                                     90 	.area GSINIT  (CODE)
                                     91 	.area GSFINAL (CODE)
                                     92 	.area CSEG    (CODE)
                                     93 ;--------------------------------------------------------
                                     94 ; global & static initialisations
                                     95 ;--------------------------------------------------------
                                     96 	.area HOME    (CODE)
                                     97 	.area GSINIT  (CODE)
                                     98 	.area GSFINAL (CODE)
                                     99 	.area GSINIT  (CODE)
                                    100 ;--------------------------------------------------------
                                    101 ; Home
                                    102 ;--------------------------------------------------------
                                    103 	.area HOME    (CODE)
                                    104 	.area HOME    (CODE)
                                    105 ;--------------------------------------------------------
                                    106 ; code
                                    107 ;--------------------------------------------------------
                                    108 	.area CSEG    (CODE)
                                    109 ;------------------------------------------------------------
                                    110 ;Allocation info for local variables in function 'mbrtoc32'
                                    111 ;------------------------------------------------------------
                                    112 ;sloc0                     Allocated with name '_mbrtoc32_sloc0_1_0'
                                    113 ;sloc1                     Allocated with name '_mbrtoc32_sloc1_1_0'
                                    114 ;s                         Allocated with name '_mbrtoc32_PARM_2'
                                    115 ;n                         Allocated with name '_mbrtoc32_PARM_3'
                                    116 ;ps                        Allocated with name '_mbrtoc32_PARM_4'
                                    117 ;pc32                      Allocated with name '_mbrtoc32_pc32_65536_15'
                                    118 ;wc                        Allocated with name '_mbrtoc32_wc_65536_16'
                                    119 ;ret                       Allocated with name '_mbrtoc32_ret_65536_16'
                                    120 ;sps                       Allocated with name '_mbrtoc32_sps_65536_16'
                                    121 ;------------------------------------------------------------
                                    122 ;	mbrtoc32.c:34: size_t mbrtoc32(char32_t *restrict pc32, const char *restrict s, size_t n, mbstate_t *restrict ps)
                                    123 ;	-----------------------------------------
                                    124 ;	 function mbrtoc32
                                    125 ;	-----------------------------------------
      000000                        126 _mbrtoc32:
                           000007   127 	ar7 = 0x07
                           000006   128 	ar6 = 0x06
                           000005   129 	ar5 = 0x05
                           000004   130 	ar4 = 0x04
                           000003   131 	ar3 = 0x03
                           000002   132 	ar2 = 0x02
                           000001   133 	ar1 = 0x01
                           000000   134 	ar0 = 0x00
      000000 AF F0            [24]  135 	mov	r7,b
      000002 AE 83            [24]  136 	mov	r6,dph
      000004 E5 82            [12]  137 	mov	a,dpl
      000006 90r00r08         [24]  138 	mov	dptr,#_mbrtoc32_pc32_65536_15
      000009 F0               [24]  139 	movx	@dptr,a
      00000A EE               [12]  140 	mov	a,r6
      00000B A3               [24]  141 	inc	dptr
      00000C F0               [24]  142 	movx	@dptr,a
      00000D EF               [12]  143 	mov	a,r7
      00000E A3               [24]  144 	inc	dptr
      00000F F0               [24]  145 	movx	@dptr,a
                                    146 ;	mbrtoc32.c:40: if(!ps)
      000010 90r00r05         [24]  147 	mov	dptr,#_mbrtoc32_PARM_4
      000013 E0               [24]  148 	movx	a,@dptr
      000014 F5 F0            [12]  149 	mov	b,a
      000016 A3               [24]  150 	inc	dptr
      000017 E0               [24]  151 	movx	a,@dptr
      000018 45 F0            [12]  152 	orl	a,b
      00001A 70 0D            [24]  153 	jnz	00102$
                                    154 ;	mbrtoc32.c:41: ps = &sps;
      00001C 90r00r05         [24]  155 	mov	dptr,#_mbrtoc32_PARM_4
      00001F 74r0F            [12]  156 	mov	a,#_mbrtoc32_sps_65536_16
      000021 F0               [24]  157 	movx	@dptr,a
      000022 74s00            [12]  158 	mov	a,#(_mbrtoc32_sps_65536_16 >> 8)
      000024 A3               [24]  159 	inc	dptr
      000025 F0               [24]  160 	movx	@dptr,a
      000026 E4               [12]  161 	clr	a
      000027 A3               [24]  162 	inc	dptr
      000028 F0               [24]  163 	movx	@dptr,a
      000029                        164 00102$:
                                    165 ;	mbrtoc32.c:43: if(!pc32)
      000029 90r00r08         [24]  166 	mov	dptr,#_mbrtoc32_pc32_65536_15
      00002C E0               [24]  167 	movx	a,@dptr
      00002D FD               [12]  168 	mov	r5,a
      00002E A3               [24]  169 	inc	dptr
      00002F E0               [24]  170 	movx	a,@dptr
      000030 FE               [12]  171 	mov	r6,a
      000031 A3               [24]  172 	inc	dptr
      000032 E0               [24]  173 	movx	a,@dptr
      000033 FF               [12]  174 	mov	r7,a
      000034 90r00r08         [24]  175 	mov	dptr,#_mbrtoc32_pc32_65536_15
      000037 E0               [24]  176 	movx	a,@dptr
      000038 F5 F0            [12]  177 	mov	b,a
      00003A A3               [24]  178 	inc	dptr
      00003B E0               [24]  179 	movx	a,@dptr
      00003C 45 F0            [12]  180 	orl	a,b
      00003E 70 4F            [24]  181 	jnz	00104$
                                    182 ;	mbrtoc32.c:44: return(mbrtowc(0, s, n, ps));
      000040 90r00r00         [24]  183 	mov	dptr,#_mbrtoc32_PARM_2
      000043 E0               [24]  184 	movx	a,@dptr
      000044 F5*02            [12]  185 	mov	_mbrtoc32_sloc1_1_0,a
      000046 A3               [24]  186 	inc	dptr
      000047 E0               [24]  187 	movx	a,@dptr
      000048 F5*03            [12]  188 	mov	(_mbrtoc32_sloc1_1_0 + 1),a
      00004A A3               [24]  189 	inc	dptr
      00004B E0               [24]  190 	movx	a,@dptr
      00004C F5*04            [12]  191 	mov	(_mbrtoc32_sloc1_1_0 + 2),a
      00004E 90r00r03         [24]  192 	mov	dptr,#_mbrtoc32_PARM_3
      000051 E0               [24]  193 	movx	a,@dptr
      000052 F5*00            [12]  194 	mov	_mbrtoc32_sloc0_1_0,a
      000054 A3               [24]  195 	inc	dptr
      000055 E0               [24]  196 	movx	a,@dptr
      000056 F5*01            [12]  197 	mov	(_mbrtoc32_sloc0_1_0 + 1),a
      000058 90r00r05         [24]  198 	mov	dptr,#_mbrtoc32_PARM_4
      00005B E0               [24]  199 	movx	a,@dptr
      00005C F8               [12]  200 	mov	r0,a
      00005D A3               [24]  201 	inc	dptr
      00005E E0               [24]  202 	movx	a,@dptr
      00005F F9               [12]  203 	mov	r1,a
      000060 A3               [24]  204 	inc	dptr
      000061 E0               [24]  205 	movx	a,@dptr
      000062 FC               [12]  206 	mov	r4,a
      000063 90r00r00         [24]  207 	mov	dptr,#_mbrtowc_PARM_2
      000066 E5*02            [12]  208 	mov	a,_mbrtoc32_sloc1_1_0
      000068 F0               [24]  209 	movx	@dptr,a
      000069 E5*03            [12]  210 	mov	a,(_mbrtoc32_sloc1_1_0 + 1)
      00006B A3               [24]  211 	inc	dptr
      00006C F0               [24]  212 	movx	@dptr,a
      00006D E5*04            [12]  213 	mov	a,(_mbrtoc32_sloc1_1_0 + 2)
      00006F A3               [24]  214 	inc	dptr
      000070 F0               [24]  215 	movx	@dptr,a
      000071 90r00r00         [24]  216 	mov	dptr,#_mbrtowc_PARM_3
      000074 E5*00            [12]  217 	mov	a,_mbrtoc32_sloc0_1_0
      000076 F0               [24]  218 	movx	@dptr,a
      000077 E5*01            [12]  219 	mov	a,(_mbrtoc32_sloc0_1_0 + 1)
      000079 A3               [24]  220 	inc	dptr
      00007A F0               [24]  221 	movx	@dptr,a
      00007B 90r00r00         [24]  222 	mov	dptr,#_mbrtowc_PARM_4
      00007E E8               [12]  223 	mov	a,r0
      00007F F0               [24]  224 	movx	@dptr,a
      000080 E9               [12]  225 	mov	a,r1
      000081 A3               [24]  226 	inc	dptr
      000082 F0               [24]  227 	movx	@dptr,a
      000083 EC               [12]  228 	mov	a,r4
      000084 A3               [24]  229 	inc	dptr
      000085 F0               [24]  230 	movx	@dptr,a
      000086 90 00 00         [24]  231 	mov	dptr,#0x0000
      000089 75 F0 00         [24]  232 	mov	b,#0x00
      00008C 02r00r00         [24]  233 	ljmp	_mbrtowc
      00008F                        234 00104$:
                                    235 ;	mbrtoc32.c:46: ret = mbrtowc(&wc, s, n, ps);
      00008F C0 05            [24]  236 	push	ar5
      000091 C0 06            [24]  237 	push	ar6
      000093 C0 07            [24]  238 	push	ar7
      000095 90r00r00         [24]  239 	mov	dptr,#_mbrtoc32_PARM_2
      000098 E0               [24]  240 	movx	a,@dptr
      000099 FA               [12]  241 	mov	r2,a
      00009A A3               [24]  242 	inc	dptr
      00009B E0               [24]  243 	movx	a,@dptr
      00009C FB               [12]  244 	mov	r3,a
      00009D A3               [24]  245 	inc	dptr
      00009E E0               [24]  246 	movx	a,@dptr
      00009F FC               [12]  247 	mov	r4,a
      0000A0 90r00r03         [24]  248 	mov	dptr,#_mbrtoc32_PARM_3
      0000A3 E0               [24]  249 	movx	a,@dptr
      0000A4 F8               [12]  250 	mov	r0,a
      0000A5 A3               [24]  251 	inc	dptr
      0000A6 E0               [24]  252 	movx	a,@dptr
      0000A7 F9               [12]  253 	mov	r1,a
      0000A8 90r00r05         [24]  254 	mov	dptr,#_mbrtoc32_PARM_4
      0000AB E0               [24]  255 	movx	a,@dptr
      0000AC FD               [12]  256 	mov	r5,a
      0000AD A3               [24]  257 	inc	dptr
      0000AE E0               [24]  258 	movx	a,@dptr
      0000AF FE               [12]  259 	mov	r6,a
      0000B0 A3               [24]  260 	inc	dptr
      0000B1 E0               [24]  261 	movx	a,@dptr
      0000B2 FF               [12]  262 	mov	r7,a
      0000B3 90r00r00         [24]  263 	mov	dptr,#_mbrtowc_PARM_2
      0000B6 EA               [12]  264 	mov	a,r2
      0000B7 F0               [24]  265 	movx	@dptr,a
      0000B8 EB               [12]  266 	mov	a,r3
      0000B9 A3               [24]  267 	inc	dptr
      0000BA F0               [24]  268 	movx	@dptr,a
      0000BB EC               [12]  269 	mov	a,r4
      0000BC A3               [24]  270 	inc	dptr
      0000BD F0               [24]  271 	movx	@dptr,a
      0000BE 90r00r00         [24]  272 	mov	dptr,#_mbrtowc_PARM_3
      0000C1 E8               [12]  273 	mov	a,r0
      0000C2 F0               [24]  274 	movx	@dptr,a
      0000C3 E9               [12]  275 	mov	a,r1
      0000C4 A3               [24]  276 	inc	dptr
      0000C5 F0               [24]  277 	movx	@dptr,a
      0000C6 90r00r00         [24]  278 	mov	dptr,#_mbrtowc_PARM_4
      0000C9 ED               [12]  279 	mov	a,r5
      0000CA F0               [24]  280 	movx	@dptr,a
      0000CB EE               [12]  281 	mov	a,r6
      0000CC A3               [24]  282 	inc	dptr
      0000CD F0               [24]  283 	movx	@dptr,a
      0000CE EF               [12]  284 	mov	a,r7
      0000CF A3               [24]  285 	inc	dptr
      0000D0 F0               [24]  286 	movx	@dptr,a
      0000D1 90r00r0B         [24]  287 	mov	dptr,#_mbrtoc32_wc_65536_16
      0000D4 75 F0 00         [24]  288 	mov	b,#0x00
      0000D7 C0 07            [24]  289 	push	ar7
      0000D9 C0 06            [24]  290 	push	ar6
      0000DB C0 05            [24]  291 	push	ar5
      0000DD 12r00r00         [24]  292 	lcall	_mbrtowc
      0000E0 85 82*02         [24]  293 	mov	_mbrtoc32_sloc1_1_0,dpl
      0000E3 85 83*03         [24]  294 	mov	(_mbrtoc32_sloc1_1_0 + 1),dph
      0000E6 D0 05            [24]  295 	pop	ar5
      0000E8 D0 06            [24]  296 	pop	ar6
      0000EA D0 07            [24]  297 	pop	ar7
                                    298 ;	mbrtoc32.c:48: if(ret <= MB_LEN_MAX)
      0000EC C3               [12]  299 	clr	c
      0000ED 74 04            [12]  300 	mov	a,#0x04
      0000EF 95*02            [12]  301 	subb	a,_mbrtoc32_sloc1_1_0
      0000F1 E4               [12]  302 	clr	a
      0000F2 95*03            [12]  303 	subb	a,(_mbrtoc32_sloc1_1_0 + 1)
      0000F4 D0 07            [24]  304 	pop	ar7
      0000F6 D0 06            [24]  305 	pop	ar6
      0000F8 D0 05            [24]  306 	pop	ar5
      0000FA 40 27            [24]  307 	jc	00106$
                                    308 ;	mbrtoc32.c:49: *pc32 = wc;
      0000FC 90r00r0B         [24]  309 	mov	dptr,#_mbrtoc32_wc_65536_16
      0000FF E0               [24]  310 	movx	a,@dptr
      000100 F9               [12]  311 	mov	r1,a
      000101 A3               [24]  312 	inc	dptr
      000102 E0               [24]  313 	movx	a,@dptr
      000103 FA               [12]  314 	mov	r2,a
      000104 A3               [24]  315 	inc	dptr
      000105 E0               [24]  316 	movx	a,@dptr
      000106 FB               [12]  317 	mov	r3,a
      000107 A3               [24]  318 	inc	dptr
      000108 E0               [24]  319 	movx	a,@dptr
      000109 FC               [12]  320 	mov	r4,a
      00010A 8D 82            [24]  321 	mov	dpl,r5
      00010C 8E 83            [24]  322 	mov	dph,r6
      00010E 8F F0            [24]  323 	mov	b,r7
      000110 E9               [12]  324 	mov	a,r1
      000111 12r00r00         [24]  325 	lcall	__gptrput
      000114 A3               [24]  326 	inc	dptr
      000115 EA               [12]  327 	mov	a,r2
      000116 12r00r00         [24]  328 	lcall	__gptrput
      000119 A3               [24]  329 	inc	dptr
      00011A EB               [12]  330 	mov	a,r3
      00011B 12r00r00         [24]  331 	lcall	__gptrput
      00011E A3               [24]  332 	inc	dptr
      00011F EC               [12]  333 	mov	a,r4
      000120 12r00r00         [24]  334 	lcall	__gptrput
      000123                        335 00106$:
                                    336 ;	mbrtoc32.c:51: return(ret);
      000123 85*02 82         [24]  337 	mov	dpl,_mbrtoc32_sloc1_1_0
      000126 85*03 83         [24]  338 	mov	dph,(_mbrtoc32_sloc1_1_0 + 1)
                                    339 ;	mbrtoc32.c:52: }
      000129 22               [24]  340 	ret
                                    341 	.area CSEG    (CODE)
                                    342 	.area CONST   (CODE)
                                    343 	.area XINIT   (CODE)
                                    344 	.area CABS    (ABS,CODE)

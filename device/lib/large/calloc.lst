                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module calloc
                                      6 	.optsdcc -mmcs51 --model-large
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _memset
                                     12 	.globl _malloc
                                     13 	.globl _calloc_PARM_2
                                     14 	.globl _calloc
                                     15 ;--------------------------------------------------------
                                     16 ; special function registers
                                     17 ;--------------------------------------------------------
                                     18 	.area RSEG    (ABS,DATA)
      000000                         19 	.org 0x0000
                                     20 ;--------------------------------------------------------
                                     21 ; special function bits
                                     22 ;--------------------------------------------------------
                                     23 	.area RSEG    (ABS,DATA)
      000000                         24 	.org 0x0000
                                     25 ;--------------------------------------------------------
                                     26 ; overlayable register banks
                                     27 ;--------------------------------------------------------
                                     28 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         29 	.ds 8
                                     30 ;--------------------------------------------------------
                                     31 ; internal ram data
                                     32 ;--------------------------------------------------------
                                     33 	.area DSEG    (DATA)
                                     34 ;--------------------------------------------------------
                                     35 ; overlayable items in internal ram
                                     36 ;--------------------------------------------------------
                                     37 ;--------------------------------------------------------
                                     38 ; indirectly addressable internal ram data
                                     39 ;--------------------------------------------------------
                                     40 	.area ISEG    (DATA)
                                     41 ;--------------------------------------------------------
                                     42 ; absolute internal ram data
                                     43 ;--------------------------------------------------------
                                     44 	.area IABS    (ABS,DATA)
                                     45 	.area IABS    (ABS,DATA)
                                     46 ;--------------------------------------------------------
                                     47 ; bit data
                                     48 ;--------------------------------------------------------
                                     49 	.area BSEG    (BIT)
                                     50 ;--------------------------------------------------------
                                     51 ; paged external ram data
                                     52 ;--------------------------------------------------------
                                     53 	.area PSEG    (PAG,XDATA)
                                     54 ;--------------------------------------------------------
                                     55 ; uninitialized external ram data
                                     56 ;--------------------------------------------------------
                                     57 	.area XSEG    (XDATA)
      000000                         58 _calloc_PARM_2:
      000000                         59 	.ds 2
      000002                         60 _calloc_nmemb_65536_64:
      000002                         61 	.ds 2
                                     62 ;--------------------------------------------------------
                                     63 ; absolute external ram data
                                     64 ;--------------------------------------------------------
                                     65 	.area XABS    (ABS,XDATA)
                                     66 ;--------------------------------------------------------
                                     67 ; initialized external ram data
                                     68 ;--------------------------------------------------------
                                     69 	.area XISEG   (XDATA)
                                     70 	.area HOME    (CODE)
                                     71 	.area GSINIT0 (CODE)
                                     72 	.area GSINIT1 (CODE)
                                     73 	.area GSINIT2 (CODE)
                                     74 	.area GSINIT3 (CODE)
                                     75 	.area GSINIT4 (CODE)
                                     76 	.area GSINIT5 (CODE)
                                     77 	.area GSINIT  (CODE)
                                     78 	.area GSFINAL (CODE)
                                     79 	.area CSEG    (CODE)
                                     80 ;--------------------------------------------------------
                                     81 ; global & static initialisations
                                     82 ;--------------------------------------------------------
                                     83 	.area HOME    (CODE)
                                     84 	.area GSINIT  (CODE)
                                     85 	.area GSFINAL (CODE)
                                     86 	.area GSINIT  (CODE)
                                     87 ;--------------------------------------------------------
                                     88 ; Home
                                     89 ;--------------------------------------------------------
                                     90 	.area HOME    (CODE)
                                     91 	.area HOME    (CODE)
                                     92 ;--------------------------------------------------------
                                     93 ; code
                                     94 ;--------------------------------------------------------
                                     95 	.area CSEG    (CODE)
                                     96 ;------------------------------------------------------------
                                     97 ;Allocation info for local variables in function 'calloc'
                                     98 ;------------------------------------------------------------
                                     99 ;size                      Allocated with name '_calloc_PARM_2'
                                    100 ;nmemb                     Allocated with name '_calloc_nmemb_65536_64'
                                    101 ;ptr                       Allocated with name '_calloc_ptr_65536_65'
                                    102 ;msize                     Allocated with name '_calloc_msize_65536_65'
                                    103 ;------------------------------------------------------------
                                    104 ;	calloc.c:42: void HEAPSPACE *calloc (size_t nmemb, size_t size)
                                    105 ;	-----------------------------------------
                                    106 ;	 function calloc
                                    107 ;	-----------------------------------------
      000000                        108 _calloc:
                           000007   109 	ar7 = 0x07
                           000006   110 	ar6 = 0x06
                           000005   111 	ar5 = 0x05
                           000004   112 	ar4 = 0x04
                           000003   113 	ar3 = 0x03
                           000002   114 	ar2 = 0x02
                           000001   115 	ar1 = 0x01
                           000000   116 	ar0 = 0x00
      000000 AF 83            [24]  117 	mov	r7,dph
      000002 E5 82            [12]  118 	mov	a,dpl
      000004 90r00r02         [24]  119 	mov	dptr,#_calloc_nmemb_65536_64
      000007 F0               [24]  120 	movx	@dptr,a
      000008 EF               [12]  121 	mov	a,r7
      000009 A3               [24]  122 	inc	dptr
      00000A F0               [24]  123 	movx	@dptr,a
                                    124 ;	calloc.c:49: unsigned long msize = (unsigned long)nmemb * (unsigned long)size;
      00000B 90r00r02         [24]  125 	mov	dptr,#_calloc_nmemb_65536_64
      00000E E0               [24]  126 	movx	a,@dptr
      00000F FE               [12]  127 	mov	r6,a
      000010 A3               [24]  128 	inc	dptr
      000011 E0               [24]  129 	movx	a,@dptr
      000012 FF               [12]  130 	mov	r7,a
      000013 7D 00            [12]  131 	mov	r5,#0x00
      000015 7C 00            [12]  132 	mov	r4,#0x00
      000017 90r00r00         [24]  133 	mov	dptr,#_calloc_PARM_2
      00001A E0               [24]  134 	movx	a,@dptr
      00001B FA               [12]  135 	mov	r2,a
      00001C A3               [24]  136 	inc	dptr
      00001D E0               [24]  137 	movx	a,@dptr
      00001E FB               [12]  138 	mov	r3,a
      00001F 90r00r00         [24]  139 	mov	dptr,#__mullong_PARM_2
      000022 EA               [12]  140 	mov	a,r2
      000023 F0               [24]  141 	movx	@dptr,a
      000024 EB               [12]  142 	mov	a,r3
      000025 A3               [24]  143 	inc	dptr
      000026 F0               [24]  144 	movx	@dptr,a
      000027 E4               [12]  145 	clr	a
      000028 A3               [24]  146 	inc	dptr
      000029 F0               [24]  147 	movx	@dptr,a
      00002A A3               [24]  148 	inc	dptr
      00002B F0               [24]  149 	movx	@dptr,a
                                    150 ;	calloc.c:54: if (msize > SIZE_MAX)
      00002C 8E 82            [24]  151 	mov	dpl,r6
      00002E 8F 83            [24]  152 	mov	dph,r7
      000030 8D F0            [24]  153 	mov	b,r5
      000032 EC               [12]  154 	mov	a,r4
      000033 12r00r00         [24]  155 	lcall	__mullong
      000036 AC 82            [24]  156 	mov	r4,dpl
      000038 AD 83            [24]  157 	mov	r5,dph
      00003A AE F0            [24]  158 	mov	r6,b
      00003C FF               [12]  159 	mov	r7,a
      00003D C3               [12]  160 	clr	c
      00003E 74 FF            [12]  161 	mov	a,#0xff
      000040 9C               [12]  162 	subb	a,r4
      000041 74 FF            [12]  163 	mov	a,#0xff
      000043 9D               [12]  164 	subb	a,r5
      000044 E4               [12]  165 	clr	a
      000045 9E               [12]  166 	subb	a,r6
      000046 E4               [12]  167 	clr	a
      000047 9F               [12]  168 	subb	a,r7
      000048 50 04            [24]  169 	jnc	00102$
                                    170 ;	calloc.c:55: return(0);
      00004A 90 00 00         [24]  171 	mov	dptr,#0x0000
      00004D 22               [24]  172 	ret
      00004E                        173 00102$:
                                    174 ;	calloc.c:57: if (ptr = malloc(msize))
      00004E 8C 82            [24]  175 	mov	dpl,r4
      000050 8D 83            [24]  176 	mov	dph,r5
      000052 C0 05            [24]  177 	push	ar5
      000054 C0 04            [24]  178 	push	ar4
      000056 12r00r00         [24]  179 	lcall	_malloc
      000059 AE 82            [24]  180 	mov	r6,dpl
      00005B AF 83            [24]  181 	mov	r7,dph
      00005D D0 04            [24]  182 	pop	ar4
      00005F D0 05            [24]  183 	pop	ar5
      000061 EE               [12]  184 	mov	a,r6
      000062 4F               [12]  185 	orl	a,r7
      000063 60 26            [24]  186 	jz	00104$
                                    187 ;	calloc.c:58: memset(ptr, 0, msize);
      000065 8E 02            [24]  188 	mov	ar2,r6
      000067 8F 03            [24]  189 	mov	ar3,r7
      000069 8B 01            [24]  190 	mov	ar1,r3
      00006B 7B 00            [12]  191 	mov	r3,#0x00
      00006D 90r00r00         [24]  192 	mov	dptr,#_memset_PARM_2
      000070 E4               [12]  193 	clr	a
      000071 F0               [24]  194 	movx	@dptr,a
      000072 90r00r00         [24]  195 	mov	dptr,#_memset_PARM_3
      000075 EC               [12]  196 	mov	a,r4
      000076 F0               [24]  197 	movx	@dptr,a
      000077 ED               [12]  198 	mov	a,r5
      000078 A3               [24]  199 	inc	dptr
      000079 F0               [24]  200 	movx	@dptr,a
      00007A 8A 82            [24]  201 	mov	dpl,r2
      00007C 89 83            [24]  202 	mov	dph,r1
      00007E 8B F0            [24]  203 	mov	b,r3
      000080 C0 07            [24]  204 	push	ar7
      000082 C0 06            [24]  205 	push	ar6
      000084 12r00r00         [24]  206 	lcall	_memset
      000087 D0 06            [24]  207 	pop	ar6
      000089 D0 07            [24]  208 	pop	ar7
      00008B                        209 00104$:
                                    210 ;	calloc.c:60: return(ptr);
      00008B 8E 82            [24]  211 	mov	dpl,r6
      00008D 8F 83            [24]  212 	mov	dph,r7
                                    213 ;	calloc.c:61: }
      00008F 22               [24]  214 	ret
                                    215 	.area CSEG    (CODE)
                                    216 	.area CONST   (CODE)
                                    217 	.area XINIT   (CODE)
                                    218 	.area CABS    (ABS,CODE)

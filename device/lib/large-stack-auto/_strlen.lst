                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module _strlen
                                      6 	.optsdcc -mmcs51 --model-large
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _strlen
                                     12 ;--------------------------------------------------------
                                     13 ; special function registers
                                     14 ;--------------------------------------------------------
                                     15 	.area RSEG    (ABS,DATA)
      000000                         16 	.org 0x0000
                                     17 ;--------------------------------------------------------
                                     18 ; special function bits
                                     19 ;--------------------------------------------------------
                                     20 	.area RSEG    (ABS,DATA)
      000000                         21 	.org 0x0000
                                     22 ;--------------------------------------------------------
                                     23 ; overlayable register banks
                                     24 ;--------------------------------------------------------
                                     25 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         26 	.ds 8
                                     27 ;--------------------------------------------------------
                                     28 ; internal ram data
                                     29 ;--------------------------------------------------------
                                     30 	.area DSEG    (DATA)
                                     31 ;--------------------------------------------------------
                                     32 ; overlayable items in internal ram
                                     33 ;--------------------------------------------------------
                                     34 ;--------------------------------------------------------
                                     35 ; indirectly addressable internal ram data
                                     36 ;--------------------------------------------------------
                                     37 	.area ISEG    (DATA)
                                     38 ;--------------------------------------------------------
                                     39 ; absolute internal ram data
                                     40 ;--------------------------------------------------------
                                     41 	.area IABS    (ABS,DATA)
                                     42 	.area IABS    (ABS,DATA)
                                     43 ;--------------------------------------------------------
                                     44 ; bit data
                                     45 ;--------------------------------------------------------
                                     46 	.area BSEG    (BIT)
                                     47 ;--------------------------------------------------------
                                     48 ; paged external ram data
                                     49 ;--------------------------------------------------------
                                     50 	.area PSEG    (PAG,XDATA)
                                     51 ;--------------------------------------------------------
                                     52 ; uninitialized external ram data
                                     53 ;--------------------------------------------------------
                                     54 	.area XSEG    (XDATA)
                                     55 ;--------------------------------------------------------
                                     56 ; absolute external ram data
                                     57 ;--------------------------------------------------------
                                     58 	.area XABS    (ABS,XDATA)
                                     59 ;--------------------------------------------------------
                                     60 ; initialized external ram data
                                     61 ;--------------------------------------------------------
                                     62 	.area XISEG   (XDATA)
                                     63 	.area HOME    (CODE)
                                     64 	.area GSINIT0 (CODE)
                                     65 	.area GSINIT1 (CODE)
                                     66 	.area GSINIT2 (CODE)
                                     67 	.area GSINIT3 (CODE)
                                     68 	.area GSINIT4 (CODE)
                                     69 	.area GSINIT5 (CODE)
                                     70 	.area GSINIT  (CODE)
                                     71 	.area GSFINAL (CODE)
                                     72 	.area CSEG    (CODE)
                                     73 ;--------------------------------------------------------
                                     74 ; global & static initialisations
                                     75 ;--------------------------------------------------------
                                     76 	.area HOME    (CODE)
                                     77 	.area GSINIT  (CODE)
                                     78 	.area GSFINAL (CODE)
                                     79 	.area GSINIT  (CODE)
                                     80 ;--------------------------------------------------------
                                     81 ; Home
                                     82 ;--------------------------------------------------------
                                     83 	.area HOME    (CODE)
                                     84 	.area HOME    (CODE)
                                     85 ;--------------------------------------------------------
                                     86 ; code
                                     87 ;--------------------------------------------------------
                                     88 	.area CSEG    (CODE)
                                     89 ;------------------------------------------------------------
                                     90 ;Allocation info for local variables in function 'strlen'
                                     91 ;------------------------------------------------------------
                                     92 ;str                       Allocated to registers 
                                     93 ;------------------------------------------------------------
                                     94 ;	_strlen.c:52: size_t strlen ( const char * str ) __naked
                                     95 ;	-----------------------------------------
                                     96 ;	 function strlen
                                     97 ;	-----------------------------------------
      000000                         98 _strlen:
                                     99 ;	naked function: no prologue.
                                    100 ;	_strlen.c:86: __endasm;
                                    101 ;	dptr holds pointer
                                    102 ;	b holds pointer memspace
                                    103 ;
                                    104 ;	char *ptr = str:
      000000 AA 82            [24]  105 	mov	r2,dpl
      000002 AB 83            [24]  106 	mov	r3,dph
                                    107 ;
                                    108 ;	while ( *ptr ) ptr++;
      000004                        109 L00101$:
      000004 12r00r00         [24]  110 	lcall	__gptrget
      000007 60 03            [24]  111 	jz	L00102$
      000009 A3               [24]  112 	inc	dptr
      00000A 80 F8            [24]  113 	sjmp	L00101$
                                    114 ;
      00000C                        115 L00102$:
                                    116 ;	return ptr - str;
      00000C C3               [12]  117 	clr	c
      00000D E5 82            [12]  118 	mov	a,dpl
      00000F 9A               [12]  119 	subb	a,r2
      000010 F5 82            [12]  120 	mov	dpl,a
                                    121 ;
      000012 E5 83            [12]  122 	mov	a,dph
      000014 9B               [12]  123 	subb	a,r3
      000015 F5 83            [12]  124 	mov	dph,a
                                    125 ;
      000017 22               [24]  126 	ret
                                    127 ;	_strlen.c:87: }
                                    128 ;	naked function: no epilogue.
                                    129 	.area CSEG    (CODE)
                                    130 	.area CONST   (CODE)
                                    131 	.area XINIT   (CODE)
                                    132 	.area CABS    (ABS,CODE)

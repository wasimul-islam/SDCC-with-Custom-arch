                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ISO C Compiler 
                              3 ; Version 4.2.14 #0 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.cs08
                              6 	.module wcstombs
                              7 	.optsdcc -ms08
                              8 	
                              9 	.area HOME    (CODE)
                             10 	.area GSINIT0 (CODE)
                             11 	.area GSINIT  (CODE)
                             12 	.area GSFINAL (CODE)
                             13 	.area CSEG    (CODE)
                             14 	.area XINIT   (CODE)
                             15 	.area CONST   (CODE)
                             16 	.area DSEG    (PAG)
                             17 	.area OSEG    (PAG, OVR)
                             18 	.area XSEG
                             19 	.area XISEG
                             20 ;--------------------------------------------------------
                             21 ; Public variables in this module
                             22 ;--------------------------------------------------------
                             23 	.globl _wctomb
                             24 	.globl _wcstombs_PARM_3
                             25 	.globl _wcstombs_PARM_2
                             26 	.globl _wcstombs
                             27 ;--------------------------------------------------------
                             28 ; ram data
                             29 ;--------------------------------------------------------
                             30 	.area DSEG    (PAG)
   0000                      31 _wcstombs_sloc0_1_0:
   0000                      32 	.ds 2
   0002                      33 _wcstombs_sloc1_1_0:
   0002                      34 	.ds 1
   0003                      35 _wcstombs_sloc2_1_0:
   0003                      36 	.ds 2
                             37 ;--------------------------------------------------------
                             38 ; overlayable items in ram
                             39 ;--------------------------------------------------------
                             40 ;--------------------------------------------------------
                             41 ; absolute ram data
                             42 ;--------------------------------------------------------
                             43 	.area IABS    (ABS)
                             44 	.area IABS    (ABS)
                             45 ;--------------------------------------------------------
                             46 ; absolute external ram data
                             47 ;--------------------------------------------------------
                             48 	.area XABS    (ABS)
                             49 ;--------------------------------------------------------
                             50 ; initialized external ram data
                             51 ;--------------------------------------------------------
                             52 	.area XISEG
                             53 ;--------------------------------------------------------
                             54 ; extended address mode data
                             55 ;--------------------------------------------------------
                             56 	.area XSEG
   0000                      57 _wcstombs_PARM_2:
   0000                      58 	.ds 2
   0002                      59 _wcstombs_PARM_3:
   0002                      60 	.ds 2
   0004                      61 _wcstombs_s_65536_36:
   0004                      62 	.ds 2
   0006                      63 _wcstombs_m_65536_37:
   0006                      64 	.ds 2
   0008                      65 _wcstombs_buffer_65536_37:
   0008                      66 	.ds 4
                             67 ;--------------------------------------------------------
                             68 ; global & static initialisations
                             69 ;--------------------------------------------------------
                             70 	.area HOME    (CODE)
                             71 	.area GSINIT  (CODE)
                             72 	.area GSFINAL (CODE)
                             73 	.area GSINIT  (CODE)
                             74 ;--------------------------------------------------------
                             75 ; Home
                             76 ;--------------------------------------------------------
                             77 	.area HOME    (CODE)
                             78 	.area HOME    (CODE)
                             79 ;--------------------------------------------------------
                             80 ; code
                             81 ;--------------------------------------------------------
                             82 	.area CSEG    (CODE)
                             83 ;------------------------------------------------------------
                             84 ;Allocation info for local variables in function 'wcstombs'
                             85 ;------------------------------------------------------------
                             86 ;sloc0                     Allocated with name '_wcstombs_sloc0_1_0'
                             87 ;sloc1                     Allocated with name '_wcstombs_sloc1_1_0'
                             88 ;sloc2                     Allocated with name '_wcstombs_sloc2_1_0'
                             89 ;pwcs                      Allocated with name '_wcstombs_PARM_2'
                             90 ;n                         Allocated with name '_wcstombs_PARM_3'
                             91 ;s                         Allocated with name '_wcstombs_s_65536_36'
                             92 ;m                         Allocated with name '_wcstombs_m_65536_37'
                             93 ;buffer                    Allocated with name '_wcstombs_buffer_65536_37'
                             94 ;b                         Allocated to registers a x 
                             95 ;------------------------------------------------------------
                             96 ;../wcstombs.c:33: size_t wcstombs(char *restrict s, const wchar_t *restrict pwcs, size_t n)
                             97 ;	-----------------------------------------
                             98 ;	 function wcstombs
                             99 ;	-----------------------------------------
                            100 ;	Register assignment is optimal.
                            101 ;	Stack space usage: 0 bytes.
   0000                     102 _wcstombs:
   0000 C7r00r05      [ 4]  103 	sta	(_wcstombs_s_65536_36 + 1)
   0003 CFr00r04      [ 4]  104 	stx	_wcstombs_s_65536_36
                            105 ;../wcstombs.c:35: size_t m = 0;
   0006 8C            [ 1]  106 	clrh
   0007 5F            [ 1]  107 	clrx
   0008 96r00r06      [ 5]  108 	sthx	_wcstombs_m_65536_37
                            109 ;../wcstombs.c:38: while(n > MB_LEN_MAX || n >= wctomb(buffer, *pwcs))
   000B 32r00r00      [ 5]  110 	ldhx	_wcstombs_PARM_2
   000E 35*00         [ 4]  111 	sthx	*_wcstombs_sloc0_1_0
   0010                     112 00107$:
   0010 A6 04         [ 2]  113 	lda	#0x04
   0012 C0r00r03      [ 4]  114 	sub	(_wcstombs_PARM_3 + 1)
   0015 4F            [ 1]  115 	clra
   0016 C2r00r02      [ 4]  116 	sbc	_wcstombs_PARM_3
   0019 25 27         [ 3]  117 	bcs	00108$
   001B 55*00         [ 4]  118 	ldhx	*_wcstombs_sloc0_1_0
   001D F6            [ 3]  119 	lda	,x
   001E C7r00r00      [ 4]  120 	sta	_wctomb_PARM_2
   0021 E6 01         [ 3]  121 	lda	1,x
   0023 C7r00r01      [ 4]  122 	sta	(_wctomb_PARM_2 + 1)
   0026 E6 02         [ 3]  123 	lda	2,x
   0028 C7r00r02      [ 4]  124 	sta	(_wctomb_PARM_2 + 2)
   002B E6 03         [ 3]  125 	lda	3,x
   002D C7r00r03      [ 4]  126 	sta	(_wctomb_PARM_2 + 3)
   0030 A6r08         [ 2]  127 	lda	#_wcstombs_buffer_65536_37
   0032 AEs00         [ 2]  128 	ldx	#>_wcstombs_buffer_65536_37
   0034 CDr00r00      [ 6]  129 	jsr	_wctomb
   0037 87            [ 2]  130 	psha
   0038 89            [ 2]  131 	pshx
   0039 8A            [ 3]  132 	pulh
   003A 88            [ 3]  133 	pulx
   003B 3Er00r02      [ 6]  134 	cphx	_wcstombs_PARM_3
   003E 23 02         [ 3]  135 	bls	00133$
   0040 20 79         [ 3]  136 	bra	00109$
   0042                     137 00133$:
   0042                     138 00108$:
                            139 ;../wcstombs.c:40: int b = wctomb(s, *pwcs);
   0042 55*00         [ 4]  140 	ldhx	*_wcstombs_sloc0_1_0
   0044 F6            [ 3]  141 	lda	,x
   0045 C7r00r00      [ 4]  142 	sta	_wctomb_PARM_2
   0048 E6 01         [ 3]  143 	lda	1,x
   004A C7r00r01      [ 4]  144 	sta	(_wctomb_PARM_2 + 1)
   004D E6 02         [ 3]  145 	lda	2,x
   004F C7r00r02      [ 4]  146 	sta	(_wctomb_PARM_2 + 2)
   0052 E6 03         [ 3]  147 	lda	3,x
   0054 C7r00r03      [ 4]  148 	sta	(_wctomb_PARM_2 + 3)
   0057 C6r00r05      [ 4]  149 	lda	(_wcstombs_s_65536_36 + 1)
   005A CEr00r04      [ 4]  150 	ldx	_wcstombs_s_65536_36
   005D CDr00r00      [ 6]  151 	jsr	_wctomb
                            152 ;../wcstombs.c:42: if(b == 1 && !*s)
   0060 A1 01         [ 2]  153 	cmp	#0x01
   0062 26 04         [ 3]  154 	bne	00134$
   0064 A3 00         [ 2]  155 	cpx	#0x00
   0066 27 02         [ 3]  156 	beq	00135$
   0068                     157 00134$:
   0068 20 0A         [ 3]  158 	bra	00102$
   006A                     159 00135$:
   006A 89            [ 2]  160 	pshx
   006B 32r00r04      [ 5]  161 	ldhx	_wcstombs_s_65536_36
   006E 87            [ 2]  162 	psha
   006F F6            [ 3]  163 	lda	,x
   0070 86            [ 3]  164 	pula
   0071 88            [ 3]  165 	pulx
   0072 27 47         [ 3]  166 	beq	00109$
                            167 ;../wcstombs.c:43: break;
   0074                     168 00102$:
                            169 ;../wcstombs.c:44: if(b < 0)
   0074 87            [ 2]  170 	psha
   0075 9F            [ 1]  171 	txa
   0076 A0 00         [ 2]  172 	sub	#0x00
   0078 86            [ 3]  173 	pula
   0079 90 04         [ 3]  174 	bge	00105$
                            175 ;../wcstombs.c:45: return(-1);
   007B A6 FF         [ 2]  176 	lda	#0xff
   007D 97            [ 1]  177 	tax
   007E 81            [ 6]  178 	rts
   007F                     179 00105$:
                            180 ;../wcstombs.c:47: n -= b;
   007F B7*04         [ 3]  181 	sta	*(_wcstombs_sloc2_1_0 + 1)
   0081 BF*03         [ 3]  182 	stx	*_wcstombs_sloc2_1_0
   0083 87            [ 2]  183 	psha
   0084 C6r00r03      [ 4]  184 	lda	(_wcstombs_PARM_3 + 1)
   0087 B0*04         [ 3]  185 	sub	*(_wcstombs_sloc2_1_0 + 1)
   0089 C7r00r03      [ 4]  186 	sta	(_wcstombs_PARM_3 + 1)
   008C C6r00r02      [ 4]  187 	lda	_wcstombs_PARM_3
   008F B2*03         [ 3]  188 	sbc	*_wcstombs_sloc2_1_0
   0091 C7r00r02      [ 4]  189 	sta	_wcstombs_PARM_3
                            190 ;../wcstombs.c:48: m += b;
   0094 B6*04         [ 3]  191 	lda	*(_wcstombs_sloc2_1_0 + 1)
   0096 CBr00r07      [ 4]  192 	add	(_wcstombs_m_65536_37 + 1)
   0099 C7r00r07      [ 4]  193 	sta	(_wcstombs_m_65536_37 + 1)
   009C B6*03         [ 3]  194 	lda	*_wcstombs_sloc2_1_0
   009E C9r00r06      [ 4]  195 	adc	_wcstombs_m_65536_37
   00A1 C7r00r06      [ 4]  196 	sta	_wcstombs_m_65536_37
   00A4 86            [ 3]  197 	pula
                            198 ;../wcstombs.c:49: s += b;
   00A5 CBr00r05      [ 4]  199 	add	(_wcstombs_s_65536_36 + 1)
   00A8 C7r00r05      [ 4]  200 	sta	(_wcstombs_s_65536_36 + 1)
   00AB 9F            [ 1]  201 	txa
   00AC C9r00r04      [ 4]  202 	adc	_wcstombs_s_65536_36
   00AF C7r00r04      [ 4]  203 	sta	_wcstombs_s_65536_36
                            204 ;../wcstombs.c:50: pwcs++;
   00B2 55*00         [ 4]  205 	ldhx	*_wcstombs_sloc0_1_0
   00B4 AF 04         [ 2]  206 	aix	#4
   00B6 35*00         [ 4]  207 	sthx	*_wcstombs_sloc0_1_0
   00B8 CCr00r10      [ 4]  208 	jmp	00107$
   00BB                     209 00109$:
                            210 ;../wcstombs.c:53: return(m);
   00BB CEr00r06      [ 4]  211 	ldx	_wcstombs_m_65536_37
   00BE C6r00r07      [ 4]  212 	lda	(_wcstombs_m_65536_37 + 1)
                            213 ;../wcstombs.c:54: }
   00C1 81            [ 6]  214 	rts
                            215 	.area CSEG    (CODE)
                            216 	.area CONST   (CODE)
                            217 	.area XINIT   (CODE)
                            218 	.area CABS    (ABS,CODE)

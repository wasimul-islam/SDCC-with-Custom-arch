                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ISO C Compiler 
                              3 ; Version 4.2.14 #0 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.cs08
                              6 	.module mbstowcs
                              7 	.optsdcc -ms08
                              8 	
                              9 	.area HOME    (CODE)
                             10 	.area GSINIT0 (CODE)
                             11 	.area GSINIT  (CODE)
                             12 	.area GSFINAL (CODE)
                             13 	.area CSEG    (CODE)
                             14 	.area XINIT   (CODE)
                             15 	.area CONST   (CODE)
                             16 	.area DSEG    (PAG)
                             17 	.area OSEG    (PAG, OVR)
                             18 	.area XSEG
                             19 	.area XISEG
                             20 ;--------------------------------------------------------
                             21 ; Public variables in this module
                             22 ;--------------------------------------------------------
                             23 	.globl _mbtowc
                             24 	.globl _mbstowcs_PARM_3
                             25 	.globl _mbstowcs_PARM_2
                             26 	.globl _mbstowcs
                             27 ;--------------------------------------------------------
                             28 ; ram data
                             29 ;--------------------------------------------------------
                             30 	.area DSEG    (PAG)
   0000                      31 _mbstowcs_sloc0_1_0:
   0000                      32 	.ds 2
   0002                      33 _mbstowcs_sloc1_1_0:
   0002                      34 	.ds 2
   0004                      35 _mbstowcs_sloc2_1_0:
   0004                      36 	.ds 2
   0006                      37 _mbstowcs_sloc3_1_0:
   0006                      38 	.ds 2
                             39 ;--------------------------------------------------------
                             40 ; overlayable items in ram
                             41 ;--------------------------------------------------------
                             42 ;--------------------------------------------------------
                             43 ; absolute ram data
                             44 ;--------------------------------------------------------
                             45 	.area IABS    (ABS)
                             46 	.area IABS    (ABS)
                             47 ;--------------------------------------------------------
                             48 ; absolute external ram data
                             49 ;--------------------------------------------------------
                             50 	.area XABS    (ABS)
                             51 ;--------------------------------------------------------
                             52 ; initialized external ram data
                             53 ;--------------------------------------------------------
                             54 	.area XISEG
                             55 ;--------------------------------------------------------
                             56 ; extended address mode data
                             57 ;--------------------------------------------------------
                             58 	.area XSEG
   0000                      59 _mbstowcs_PARM_2:
   0000                      60 	.ds 2
   0002                      61 _mbstowcs_PARM_3:
   0002                      62 	.ds 2
   0004                      63 _mbstowcs_m_65536_37:
   0004                      64 	.ds 2
                             65 ;--------------------------------------------------------
                             66 ; global & static initialisations
                             67 ;--------------------------------------------------------
                             68 	.area HOME    (CODE)
                             69 	.area GSINIT  (CODE)
                             70 	.area GSFINAL (CODE)
                             71 	.area GSINIT  (CODE)
                             72 ;--------------------------------------------------------
                             73 ; Home
                             74 ;--------------------------------------------------------
                             75 	.area HOME    (CODE)
                             76 	.area HOME    (CODE)
                             77 ;--------------------------------------------------------
                             78 ; code
                             79 ;--------------------------------------------------------
                             80 	.area CSEG    (CODE)
                             81 ;------------------------------------------------------------
                             82 ;Allocation info for local variables in function 'mbstowcs'
                             83 ;------------------------------------------------------------
                             84 ;sloc0                     Allocated with name '_mbstowcs_sloc0_1_0'
                             85 ;sloc1                     Allocated with name '_mbstowcs_sloc1_1_0'
                             86 ;sloc2                     Allocated with name '_mbstowcs_sloc2_1_0'
                             87 ;sloc3                     Allocated with name '_mbstowcs_sloc3_1_0'
                             88 ;s                         Allocated with name '_mbstowcs_PARM_2'
                             89 ;n                         Allocated with name '_mbstowcs_PARM_3'
                             90 ;pwcs                      Allocated to registers 
                             91 ;m                         Allocated with name '_mbstowcs_m_65536_37'
                             92 ;b                         Allocated to registers a x 
                             93 ;------------------------------------------------------------
                             94 ;../mbstowcs.c:33: size_t mbstowcs(wchar_t *restrict pwcs, const char *restrict s, size_t n)
                             95 ;	-----------------------------------------
                             96 ;	 function mbstowcs
                             97 ;	-----------------------------------------
                             98 ;	Register assignment is optimal.
                             99 ;	Stack space usage: 0 bytes.
   0000                     100 _mbstowcs:
   0000 B7*01         [ 3]  101 	sta	*(_mbstowcs_sloc0_1_0 + 1)
   0002 BF*00         [ 3]  102 	stx	*_mbstowcs_sloc0_1_0
                            103 ;../mbstowcs.c:35: size_t m = 0;
   0004 8C            [ 1]  104 	clrh
   0005 5F            [ 1]  105 	clrx
   0006 96r00r04      [ 5]  106 	sthx	_mbstowcs_m_65536_37
                            107 ;../mbstowcs.c:36: while(n--)
   0009 35*02         [ 4]  108 	sthx	*_mbstowcs_sloc1_1_0
   000B 32r00r02      [ 5]  109 	ldhx	_mbstowcs_PARM_3
   000E 35*04         [ 4]  110 	sthx	*_mbstowcs_sloc2_1_0
   0010                     111 00105$:
   0010 55*04         [ 4]  112 	ldhx	*_mbstowcs_sloc2_1_0
   0012 89            [ 2]  113 	pshx
   0013 8B            [ 2]  114 	pshh
   0014 55*04         [ 4]  115 	ldhx	*_mbstowcs_sloc2_1_0
   0016 AF FF         [ 2]  116 	aix	#-1
   0018 35*04         [ 4]  117 	sthx	*_mbstowcs_sloc2_1_0
   001A 8A            [ 3]  118 	pulh
   001B 88            [ 3]  119 	pulx
   001C 65 00 00      [ 3]  120 	cphx	#0x00
   001F 27 4F         [ 3]  121 	beq	00107$
                            122 ;../mbstowcs.c:38: int b = mbtowc(pwcs++, s, MB_LEN_MAX);
   0021 4E*00*06      [ 6]  123 	mov	*_mbstowcs_sloc0_1_0,*_mbstowcs_sloc3_1_0
   0024 4E*01*07      [ 6]  124 	mov	*(_mbstowcs_sloc0_1_0 + 1),*(_mbstowcs_sloc3_1_0 + 1)
   0027 55*00         [ 4]  125 	ldhx	*_mbstowcs_sloc0_1_0
   0029 AF 04         [ 2]  126 	aix	#4
   002B 35*00         [ 4]  127 	sthx	*_mbstowcs_sloc0_1_0
   002D 32r00r00      [ 5]  128 	ldhx	_mbstowcs_PARM_2
   0030 96r00r00      [ 5]  129 	sthx	_mbtowc_PARM_2
   0033 45 00 04      [ 3]  130 	ldhx	#0x0004
   0036 96r00r00      [ 5]  131 	sthx	_mbtowc_PARM_3
   0039 B6*07         [ 3]  132 	lda	*(_mbstowcs_sloc3_1_0 + 1)
   003B BE*06         [ 3]  133 	ldx	*_mbstowcs_sloc3_1_0
   003D CDr00r00      [ 6]  134 	jsr	_mbtowc
                            135 ;../mbstowcs.c:39: if(!b)
   0040 4D            [ 1]  136 	tsta
   0041 26 01         [ 3]  137 	bne	00131$
   0043 5D            [ 1]  138 	tstx
   0044                     139 00131$:
   0044 27 2A         [ 3]  140 	beq	00107$
                            141 ;../mbstowcs.c:41: if(b < 0)
   0046 87            [ 2]  142 	psha
   0047 9F            [ 1]  143 	txa
   0048 A0 00         [ 2]  144 	sub	#0x00
   004A 86            [ 3]  145 	pula
   004B 90 04         [ 3]  146 	bge	00104$
                            147 ;../mbstowcs.c:42: return(-1);
   004D A6 FF         [ 2]  148 	lda	#0xff
   004F 97            [ 1]  149 	tax
   0050 81            [ 6]  150 	rts
   0051                     151 00104$:
                            152 ;../mbstowcs.c:43: s += b;
   0051 CBr00r01      [ 4]  153 	add	(_mbstowcs_PARM_2 + 1)
   0054 C7r00r01      [ 4]  154 	sta	(_mbstowcs_PARM_2 + 1)
   0057 9F            [ 1]  155 	txa
   0058 C9r00r00      [ 4]  156 	adc	_mbstowcs_PARM_2
   005B C7r00r00      [ 4]  157 	sta	_mbstowcs_PARM_2
                            158 ;../mbstowcs.c:44: m++;
   005E 55*02         [ 4]  159 	ldhx	*_mbstowcs_sloc1_1_0
   0060 AF 01         [ 2]  160 	aix	#1
   0062 35*02         [ 4]  161 	sthx	*_mbstowcs_sloc1_1_0
   0064 B6*02         [ 3]  162 	lda	*_mbstowcs_sloc1_1_0
   0066 C7r00r04      [ 4]  163 	sta	_mbstowcs_m_65536_37
   0069 B6*03         [ 3]  164 	lda	*(_mbstowcs_sloc1_1_0 + 1)
   006B C7r00r05      [ 4]  165 	sta	(_mbstowcs_m_65536_37 + 1)
   006E 20 A0         [ 3]  166 	bra	00105$
   0070                     167 00107$:
                            168 ;../mbstowcs.c:47: return(m);
   0070 CEr00r04      [ 4]  169 	ldx	_mbstowcs_m_65536_37
   0073 C6r00r05      [ 4]  170 	lda	(_mbstowcs_m_65536_37 + 1)
                            171 ;../mbstowcs.c:48: }
   0076 81            [ 6]  172 	rts
                            173 	.area CSEG    (CODE)
                            174 	.area CONST   (CODE)
                            175 	.area XINIT   (CODE)
                            176 	.area CABS    (ABS,CODE)

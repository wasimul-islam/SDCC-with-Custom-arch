                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ISO C Compiler 
                              3 ; Version 4.2.14 #0 (Linux)
                              4 ;--------------------------------------------------------
                              5 	.module wcstombs
                              6 	.optsdcc -mmos6502
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _wctomb
                             12 	.globl _wcstombs_PARM_3
                             13 	.globl _wcstombs_PARM_2
                             14 	.globl _wcstombs
                             15 ;--------------------------------------------------------
                             16 ; ZP ram data
                             17 ;--------------------------------------------------------
                             18 	.area ZP      (PAG)
   0000                      19 _wcstombs_sloc0_1_0:
   0000                      20 	.ds 2
                             21 ;--------------------------------------------------------
                             22 ; overlayable items in ram
                             23 ;--------------------------------------------------------
                             24 ;--------------------------------------------------------
                             25 ; uninitialized external ram data
                             26 ;--------------------------------------------------------
                             27 	.area BSS
   0000                      28 _wcstombs_PARM_2:
   0000                      29 	.ds 2
   0002                      30 _wcstombs_PARM_3:
   0002                      31 	.ds 2
   0004                      32 _wcstombs_s_65536_36:
   0004                      33 	.ds 2
   0006                      34 _wcstombs_m_65536_37:
   0006                      35 	.ds 2
   0008                      36 _wcstombs_buffer_65536_37:
   0008                      37 	.ds 4
   000C                      38 _wcstombs_b_131072_38:
   000C                      39 	.ds 2
                             40 ;--------------------------------------------------------
                             41 ; absolute external ram data
                             42 ;--------------------------------------------------------
                             43 	.area DABS    (ABS)
                             44 ;--------------------------------------------------------
                             45 ; initialized external ram data
                             46 ;--------------------------------------------------------
                             47 	.area DATA
                             48 ;--------------------------------------------------------
                             49 ; global & static initialisations
                             50 ;--------------------------------------------------------
                             51 	.area _CODE
                             52 	.area GSINIT
                             53 	.area GSFINAL
                             54 	.area GSINIT
                             55 ;--------------------------------------------------------
                             56 ; Home
                             57 ;--------------------------------------------------------
                             58 	.area _CODE
                             59 	.area _CODE
                             60 ;--------------------------------------------------------
                             61 ; code
                             62 ;--------------------------------------------------------
                             63 	.area CODE
                             64 ;------------------------------------------------------------
                             65 ;Allocation info for local variables in function 'wcstombs'
                             66 ;------------------------------------------------------------
                             67 ;sloc0                     Allocated with name '_wcstombs_sloc0_1_0'
                             68 ;pwcs                      Allocated with name '_wcstombs_PARM_2'
                             69 ;n                         Allocated with name '_wcstombs_PARM_3'
                             70 ;s                         Allocated with name '_wcstombs_s_65536_36'
                             71 ;m                         Allocated with name '_wcstombs_m_65536_37'
                             72 ;buffer                    Allocated with name '_wcstombs_buffer_65536_37'
                             73 ;b                         Allocated with name '_wcstombs_b_131072_38'
                             74 ;------------------------------------------------------------
                             75 ;	../wcstombs.c: 33: size_t wcstombs(char *restrict s, const wchar_t *restrict pwcs, size_t n)
                             76 ;	-----------------------------------------
                             77 ;	 function wcstombs
                             78 ;	-----------------------------------------
                             79 ;	Register assignment is optimal.
                             80 ;	Stack space usage: 0 bytes.
   0000                      81 _wcstombs:
   0000 8Dr04r00      [ 4]   82 	sta	_wcstombs_s_65536_36
   0003 8Er05r00      [ 4]   83 	stx	(_wcstombs_s_65536_36 + 1)
                             84 ;	../wcstombs.c: 35: size_t m = 0;
   0006 A2 00         [ 2]   85 	ldx	#0x00
   0008 8Er06r00      [ 4]   86 	stx	_wcstombs_m_65536_37
   000B 8Er07r00      [ 4]   87 	stx	(_wcstombs_m_65536_37 + 1)
                             88 ;	../wcstombs.c: 38: while(n > MB_LEN_MAX || n >= wctomb(buffer, *pwcs))
   000E ADr00r00      [ 4]   89 	lda	_wcstombs_PARM_2
   0011 85*00         [ 3]   90 	sta	*_wcstombs_sloc0_1_0
   0013 ADr01r00      [ 4]   91 	lda	(_wcstombs_PARM_2 + 1)
   0016 85*01         [ 3]   92 	sta	*(_wcstombs_sloc0_1_0 + 1)
   0018                      93 00107$:
   0018 A9 04         [ 2]   94 	lda	#0x04
   001A 38            [ 2]   95 	sec
   001B EDr02r00      [ 4]   96 	sbc	_wcstombs_PARM_3
   001E A9 00         [ 2]   97 	lda	#0x00
   0020 EDr03r00      [ 4]   98 	sbc	(_wcstombs_PARM_3 + 1)
   0023 90 34         [ 4]   99 	bcc	00108$
   0025 A0 00         [ 2]  100 	ldy	#0x00
   0027 B1*00         [ 6]  101 	lda	[*_wcstombs_sloc0_1_0],y
   0029 8Dr00r00      [ 4]  102 	sta	_wctomb_PARM_2
   002C C8            [ 2]  103 	iny
   002D B1*00         [ 6]  104 	lda	[*_wcstombs_sloc0_1_0],y
   002F 8Dr01r00      [ 4]  105 	sta	(_wctomb_PARM_2 + 1)
   0032 C8            [ 2]  106 	iny
   0033 B1*00         [ 6]  107 	lda	[*_wcstombs_sloc0_1_0],y
   0035 8Dr02r00      [ 4]  108 	sta	(_wctomb_PARM_2 + 2)
   0038 C8            [ 2]  109 	iny
   0039 B1*00         [ 6]  110 	lda	[*_wcstombs_sloc0_1_0],y
   003B 8Dr03r00      [ 4]  111 	sta	(_wctomb_PARM_2 + 3)
   003E A2s00         [ 2]  112 	ldx	#>_wcstombs_buffer_65536_37
   0040 A9r08         [ 2]  113 	lda	#_wcstombs_buffer_65536_37
   0042 20r00r00      [ 6]  114 	jsr	_wctomb
   0045 85*00         [ 3]  115 	sta	*(__TEMP+0)
   0047 ADr02r00      [ 4]  116 	lda	_wcstombs_PARM_3
   004A 38            [ 2]  117 	sec
   004B E5*00         [ 3]  118 	sbc	*(__TEMP+0)
   004D ADr03r00      [ 4]  119 	lda	(_wcstombs_PARM_3 + 1)
   0050 86*00         [ 3]  120 	stx	*(__TEMP+0)
   0052 E5*00         [ 3]  121 	sbc	*(__TEMP+0)
   0054 B0 03         [ 4]  122 	bcs	00129$
   0056 4CrFBr00      [ 3]  123 	jmp	00109$
   0059                     124 00129$:
   0059                     125 00108$:
                            126 ;	../wcstombs.c: 40: int b = wctomb(s, *pwcs);
   0059 A0 00         [ 2]  127 	ldy	#0x00
   005B B1*00         [ 6]  128 	lda	[*_wcstombs_sloc0_1_0],y
   005D 8Dr00r00      [ 4]  129 	sta	_wctomb_PARM_2
   0060 C8            [ 2]  130 	iny
   0061 B1*00         [ 6]  131 	lda	[*_wcstombs_sloc0_1_0],y
   0063 8Dr01r00      [ 4]  132 	sta	(_wctomb_PARM_2 + 1)
   0066 C8            [ 2]  133 	iny
   0067 B1*00         [ 6]  134 	lda	[*_wcstombs_sloc0_1_0],y
   0069 8Dr02r00      [ 4]  135 	sta	(_wctomb_PARM_2 + 2)
   006C C8            [ 2]  136 	iny
   006D B1*00         [ 6]  137 	lda	[*_wcstombs_sloc0_1_0],y
   006F 8Dr03r00      [ 4]  138 	sta	(_wctomb_PARM_2 + 3)
   0072 AEr05r00      [ 4]  139 	ldx	(_wcstombs_s_65536_36 + 1)
   0075 ADr04r00      [ 4]  140 	lda	_wcstombs_s_65536_36
   0078 20r00r00      [ 6]  141 	jsr	_wctomb
   007B 8Dr0Cr00      [ 4]  142 	sta	_wcstombs_b_131072_38
   007E 8Er0Dr00      [ 4]  143 	stx	(_wcstombs_b_131072_38 + 1)
                            144 ;	../wcstombs.c: 42: if(b == 1 && !*s)
   0081 ADr0Cr00      [ 4]  145 	lda	_wcstombs_b_131072_38
   0084 C9 01         [ 2]  146 	cmp	#0x01
   0086 D0 15         [ 4]  147 	bne	00102$
   0088 ADr0Dr00      [ 4]  148 	lda	(_wcstombs_b_131072_38 + 1)
   008B D0 10         [ 4]  149 	bne	00102$
   008D ADr04r00      [ 4]  150 	lda	_wcstombs_s_65536_36
   0090 85*00         [ 3]  151 	sta	*(__DPTR+0)
   0092 ADr05r00      [ 4]  152 	lda	(_wcstombs_s_65536_36 + 1)
   0095 85*01         [ 3]  153 	sta	*(__DPTR+1)
   0097 A0 00         [ 2]  154 	ldy	#0x00
   0099 B1*00         [ 6]  155 	lda	[__DPTR],y
   009B F0 5E         [ 4]  156 	beq	00109$
                            157 ;	../wcstombs.c: 43: break;
   009D                     158 00102$:
                            159 ;	../wcstombs.c: 44: if(b < 0)
   009D ADr0Dr00      [ 4]  160 	lda	(_wcstombs_b_131072_38 + 1)
   00A0 38            [ 2]  161 	sec
   00A1 E9 00         [ 2]  162 	sbc	#0x00
   00A3 50 04         [ 4]  163 	bvc	00135$
   00A5 10 04         [ 4]  164 	bpl	00134$
   00A7 30 06         [ 4]  165 	bmi	00105$
   00A9                     166 00135$:
   00A9 10 04         [ 4]  167 	bpl	00105$
   00AB                     168 00134$:
                            169 ;	../wcstombs.c: 45: return(-1);
   00AB A9 FF         [ 2]  170 	lda	#0xff
   00AD AA            [ 2]  171 	tax
   00AE 60            [ 6]  172 	rts
   00AF                     173 00105$:
                            174 ;	../wcstombs.c: 47: n -= b;
   00AF ADr0Cr00      [ 4]  175 	lda	_wcstombs_b_131072_38
   00B2 AEr0Dr00      [ 4]  176 	ldx	(_wcstombs_b_131072_38 + 1)
   00B5 48            [ 3]  177 	pha
   00B6 85*00         [ 3]  178 	sta	*(__TEMP+0)
   00B8 ADr02r00      [ 4]  179 	lda	_wcstombs_PARM_3
   00BB 38            [ 2]  180 	sec
   00BC E5*00         [ 3]  181 	sbc	*(__TEMP+0)
   00BE 8Dr02r00      [ 4]  182 	sta	_wcstombs_PARM_3
   00C1 ADr03r00      [ 4]  183 	lda	(_wcstombs_PARM_3 + 1)
   00C4 86*00         [ 3]  184 	stx	*(__TEMP+0)
   00C6 E5*00         [ 3]  185 	sbc	*(__TEMP+0)
   00C8 8Dr03r00      [ 4]  186 	sta	(_wcstombs_PARM_3 + 1)
   00CB 68            [ 4]  187 	pla
                            188 ;	../wcstombs.c: 48: m += b;
   00CC 18            [ 2]  189 	clc
   00CD 6Dr06r00      [ 4]  190 	adc	_wcstombs_m_65536_37
   00D0 8Dr06r00      [ 4]  191 	sta	_wcstombs_m_65536_37
   00D3 8A            [ 2]  192 	txa
   00D4 6Dr07r00      [ 4]  193 	adc	(_wcstombs_m_65536_37 + 1)
   00D7 8Dr07r00      [ 4]  194 	sta	(_wcstombs_m_65536_37 + 1)
                            195 ;	../wcstombs.c: 49: s += b;
   00DA ADr04r00      [ 4]  196 	lda	_wcstombs_s_65536_36
   00DD 18            [ 2]  197 	clc
   00DE 6Dr0Cr00      [ 4]  198 	adc	_wcstombs_b_131072_38
   00E1 8Dr04r00      [ 4]  199 	sta	_wcstombs_s_65536_36
   00E4 ADr05r00      [ 4]  200 	lda	(_wcstombs_s_65536_36 + 1)
   00E7 6Dr0Dr00      [ 4]  201 	adc	(_wcstombs_b_131072_38 + 1)
   00EA 8Dr05r00      [ 4]  202 	sta	(_wcstombs_s_65536_36 + 1)
                            203 ;	../wcstombs.c: 50: pwcs++;
   00ED A5*00         [ 3]  204 	lda	*_wcstombs_sloc0_1_0
   00EF 18            [ 2]  205 	clc
   00F0 69 04         [ 2]  206 	adc	#0x04
   00F2 85*00         [ 3]  207 	sta	*_wcstombs_sloc0_1_0
   00F4 90 02         [ 4]  208 	bcc	00137$
   00F6 E6*01         [ 5]  209 	inc	*(_wcstombs_sloc0_1_0 + 1)
   00F8                     210 00137$:
   00F8 4Cr18r00      [ 3]  211 	jmp	00107$
   00FB                     212 00109$:
                            213 ;	../wcstombs.c: 53: return(m);
   00FB AEr07r00      [ 4]  214 	ldx	(_wcstombs_m_65536_37 + 1)
   00FE ADr06r00      [ 4]  215 	lda	_wcstombs_m_65536_37
                            216 ;	../wcstombs.c: 54: }
   0101 60            [ 6]  217 	rts
                            218 	.area CODE
                            219 	.area RODATA
                            220 	.area XINIT
                            221 	.area CABS    (ABS)

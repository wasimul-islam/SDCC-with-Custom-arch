                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module mbstowcs
                                      6 	.optsdcc -mmcs51 --model-medium
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _mbtowc
                                     12 	.globl _mbstowcs_PARM_3
                                     13 	.globl _mbstowcs_PARM_2
                                     14 	.globl _mbstowcs
                                     15 ;--------------------------------------------------------
                                     16 ; special function registers
                                     17 ;--------------------------------------------------------
                                     18 	.area RSEG    (ABS,DATA)
      000000                         19 	.org 0x0000
                                     20 ;--------------------------------------------------------
                                     21 ; special function bits
                                     22 ;--------------------------------------------------------
                                     23 	.area RSEG    (ABS,DATA)
      000000                         24 	.org 0x0000
                                     25 ;--------------------------------------------------------
                                     26 ; overlayable register banks
                                     27 ;--------------------------------------------------------
                                     28 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         29 	.ds 8
                                     30 ;--------------------------------------------------------
                                     31 ; internal ram data
                                     32 ;--------------------------------------------------------
                                     33 	.area DSEG    (DATA)
      000000                         34 _mbstowcs_sloc0_1_0:
      000000                         35 	.ds 2
      000002                         36 _mbstowcs_sloc1_1_0:
      000002                         37 	.ds 2
                                     38 ;--------------------------------------------------------
                                     39 ; overlayable items in internal ram
                                     40 ;--------------------------------------------------------
                                     41 ;--------------------------------------------------------
                                     42 ; indirectly addressable internal ram data
                                     43 ;--------------------------------------------------------
                                     44 	.area ISEG    (DATA)
                                     45 ;--------------------------------------------------------
                                     46 ; absolute internal ram data
                                     47 ;--------------------------------------------------------
                                     48 	.area IABS    (ABS,DATA)
                                     49 	.area IABS    (ABS,DATA)
                                     50 ;--------------------------------------------------------
                                     51 ; bit data
                                     52 ;--------------------------------------------------------
                                     53 	.area BSEG    (BIT)
                                     54 ;--------------------------------------------------------
                                     55 ; paged external ram data
                                     56 ;--------------------------------------------------------
                                     57 	.area PSEG    (PAG,XDATA)
      000000                         58 _mbstowcs_PARM_2:
      000000                         59 	.ds 3
      000003                         60 _mbstowcs_PARM_3:
      000003                         61 	.ds 2
      000005                         62 _mbstowcs_m_65536_40:
      000005                         63 	.ds 2
                                     64 ;--------------------------------------------------------
                                     65 ; uninitialized external ram data
                                     66 ;--------------------------------------------------------
                                     67 	.area XSEG    (XDATA)
                                     68 ;--------------------------------------------------------
                                     69 ; absolute external ram data
                                     70 ;--------------------------------------------------------
                                     71 	.area XABS    (ABS,XDATA)
                                     72 ;--------------------------------------------------------
                                     73 ; initialized external ram data
                                     74 ;--------------------------------------------------------
                                     75 	.area XISEG   (XDATA)
                                     76 	.area HOME    (CODE)
                                     77 	.area GSINIT0 (CODE)
                                     78 	.area GSINIT1 (CODE)
                                     79 	.area GSINIT2 (CODE)
                                     80 	.area GSINIT3 (CODE)
                                     81 	.area GSINIT4 (CODE)
                                     82 	.area GSINIT5 (CODE)
                                     83 	.area GSINIT  (CODE)
                                     84 	.area GSFINAL (CODE)
                                     85 	.area CSEG    (CODE)
                                     86 ;--------------------------------------------------------
                                     87 ; global & static initialisations
                                     88 ;--------------------------------------------------------
                                     89 	.area HOME    (CODE)
                                     90 	.area GSINIT  (CODE)
                                     91 	.area GSFINAL (CODE)
                                     92 	.area GSINIT  (CODE)
                                     93 ;--------------------------------------------------------
                                     94 ; Home
                                     95 ;--------------------------------------------------------
                                     96 	.area HOME    (CODE)
                                     97 	.area HOME    (CODE)
                                     98 ;--------------------------------------------------------
                                     99 ; code
                                    100 ;--------------------------------------------------------
                                    101 	.area CSEG    (CODE)
                                    102 ;------------------------------------------------------------
                                    103 ;Allocation info for local variables in function 'mbstowcs'
                                    104 ;------------------------------------------------------------
                                    105 ;sloc0                     Allocated with name '_mbstowcs_sloc0_1_0'
                                    106 ;sloc1                     Allocated with name '_mbstowcs_sloc1_1_0'
                                    107 ;------------------------------------------------------------
                                    108 ;	mbstowcs.c:33: size_t mbstowcs(wchar_t *restrict pwcs, const char *restrict s, size_t n)
                                    109 ;	-----------------------------------------
                                    110 ;	 function mbstowcs
                                    111 ;	-----------------------------------------
      000000                        112 _mbstowcs:
                           000007   113 	ar7 = 0x07
                           000006   114 	ar6 = 0x06
                           000005   115 	ar5 = 0x05
                           000004   116 	ar4 = 0x04
                           000003   117 	ar3 = 0x03
                           000002   118 	ar2 = 0x02
                           000001   119 	ar1 = 0x01
                           000000   120 	ar0 = 0x00
      000000 AD 82            [24]  121 	mov	r5,dpl
      000002 AE 83            [24]  122 	mov	r6,dph
      000004 AF F0            [24]  123 	mov	r7,b
                                    124 ;	mbstowcs.c:35: size_t m = 0;
      000006 E4               [12]  125 	clr	a
      000007 F5*00            [12]  126 	mov	_mbstowcs_sloc0_1_0,a
      000009 F5*01            [12]  127 	mov	(_mbstowcs_sloc0_1_0 + 1),a
                                    128 ;	mbstowcs.c:36: while(n--)
      00000B 78r05            [12]  129 	mov	r0,#_mbstowcs_m_65536_40
      00000D F2               [24]  130 	movx	@r0,a
      00000E 08               [12]  131 	inc	r0
      00000F F2               [24]  132 	movx	@r0,a
      000010 78r03            [12]  133 	mov	r0,#_mbstowcs_PARM_3
      000012 E2               [24]  134 	movx	a,@r0
      000013 F5*02            [12]  135 	mov	_mbstowcs_sloc1_1_0,a
      000015 08               [12]  136 	inc	r0
      000016 E2               [24]  137 	movx	a,@r0
      000017 F5*03            [12]  138 	mov	(_mbstowcs_sloc1_1_0 + 1),a
      000019                        139 00105$:
      000019 AB*02            [24]  140 	mov	r3,_mbstowcs_sloc1_1_0
      00001B AC*03            [24]  141 	mov	r4,(_mbstowcs_sloc1_1_0 + 1)
      00001D 15*02            [12]  142 	dec	_mbstowcs_sloc1_1_0
      00001F 74 FF            [12]  143 	mov	a,#0xff
      000021 B5*02 02         [24]  144 	cjne	a,_mbstowcs_sloc1_1_0,00126$
      000024 15*03            [12]  145 	dec	(_mbstowcs_sloc1_1_0 + 1)
      000026                        146 00126$:
      000026 EB               [12]  147 	mov	a,r3
      000027 4C               [12]  148 	orl	a,r4
      000028 60 67            [24]  149 	jz	00107$
                                    150 ;	mbstowcs.c:38: int b = mbtowc(pwcs++, s, MB_LEN_MAX);
      00002A 8D 02            [24]  151 	mov	ar2,r5
      00002C 8E 03            [24]  152 	mov	ar3,r6
      00002E 8F 04            [24]  153 	mov	ar4,r7
      000030 74 04            [12]  154 	mov	a,#0x04
      000032 2D               [12]  155 	add	a,r5
      000033 FD               [12]  156 	mov	r5,a
      000034 E4               [12]  157 	clr	a
      000035 3E               [12]  158 	addc	a,r6
      000036 FE               [12]  159 	mov	r6,a
      000037 78r00            [12]  160 	mov	r0,#_mbstowcs_PARM_2
      000039 79r00            [12]  161 	mov	r1,#_mbtowc_PARM_2
      00003B E2               [24]  162 	movx	a,@r0
      00003C F3               [24]  163 	movx	@r1,a
      00003D 08               [12]  164 	inc	r0
      00003E E2               [24]  165 	movx	a,@r0
      00003F 09               [12]  166 	inc	r1
      000040 F3               [24]  167 	movx	@r1,a
      000041 08               [12]  168 	inc	r0
      000042 E2               [24]  169 	movx	a,@r0
      000043 09               [12]  170 	inc	r1
      000044 F3               [24]  171 	movx	@r1,a
      000045 78r00            [12]  172 	mov	r0,#_mbtowc_PARM_3
      000047 74 04            [12]  173 	mov	a,#0x04
      000049 F2               [24]  174 	movx	@r0,a
      00004A E4               [12]  175 	clr	a
      00004B 08               [12]  176 	inc	r0
      00004C F2               [24]  177 	movx	@r0,a
      00004D 8A 82            [24]  178 	mov	dpl,r2
      00004F 8B 83            [24]  179 	mov	dph,r3
      000051 8C F0            [24]  180 	mov	b,r4
      000053 C0 07            [24]  181 	push	ar7
      000055 C0 06            [24]  182 	push	ar6
      000057 C0 05            [24]  183 	push	ar5
      000059 12r00r00         [24]  184 	lcall	_mbtowc
      00005C AB 82            [24]  185 	mov	r3,dpl
      00005E AC 83            [24]  186 	mov	r4,dph
      000060 D0 05            [24]  187 	pop	ar5
      000062 D0 06            [24]  188 	pop	ar6
      000064 D0 07            [24]  189 	pop	ar7
                                    190 ;	mbstowcs.c:39: if(!b)
      000066 EB               [12]  191 	mov	a,r3
      000067 4C               [12]  192 	orl	a,r4
      000068 60 27            [24]  193 	jz	00107$
                                    194 ;	mbstowcs.c:41: if(b < 0)
      00006A EC               [12]  195 	mov	a,r4
      00006B 30 E7 04         [24]  196 	jnb	acc.7,00104$
                                    197 ;	mbstowcs.c:42: return(-1);
      00006E 90 FF FF         [24]  198 	mov	dptr,#0xffff
      000071 22               [24]  199 	ret
      000072                        200 00104$:
                                    201 ;	mbstowcs.c:43: s += b;
      000072 78r00            [12]  202 	mov	r0,#_mbstowcs_PARM_2
      000074 E2               [24]  203 	movx	a,@r0
      000075 2B               [12]  204 	add	a,r3
      000076 F2               [24]  205 	movx	@r0,a
      000077 08               [12]  206 	inc	r0
      000078 E2               [24]  207 	movx	a,@r0
      000079 3C               [12]  208 	addc	a,r4
      00007A F2               [24]  209 	movx	@r0,a
                                    210 ;	mbstowcs.c:44: m++;
      00007B 78r05            [12]  211 	mov	r0,#_mbstowcs_m_65536_40
      00007D E2               [24]  212 	movx	a,@r0
      00007E 24 01            [12]  213 	add	a,#0x01
      000080 F2               [24]  214 	movx	@r0,a
      000081 08               [12]  215 	inc	r0
      000082 E2               [24]  216 	movx	a,@r0
      000083 34 00            [12]  217 	addc	a,#0x00
      000085 F2               [24]  218 	movx	@r0,a
      000086 78r05            [12]  219 	mov	r0,#_mbstowcs_m_65536_40
      000088 E2               [24]  220 	movx	a,@r0
      000089 F5*00            [12]  221 	mov	_mbstowcs_sloc0_1_0,a
      00008B 08               [12]  222 	inc	r0
      00008C E2               [24]  223 	movx	a,@r0
      00008D F5*01            [12]  224 	mov	(_mbstowcs_sloc0_1_0 + 1),a
      00008F 80 88            [24]  225 	sjmp	00105$
      000091                        226 00107$:
                                    227 ;	mbstowcs.c:47: return(m);
      000091 85*00 82         [24]  228 	mov	dpl,_mbstowcs_sloc0_1_0
      000094 85*01 83         [24]  229 	mov	dph,(_mbstowcs_sloc0_1_0 + 1)
                                    230 ;	mbstowcs.c:48: }
      000097 22               [24]  231 	ret
                                    232 	.area CSEG    (CODE)
                                    233 	.area CONST   (CODE)
                                    234 	.area XINIT   (CODE)
                                    235 	.area CABS    (ABS,CODE)

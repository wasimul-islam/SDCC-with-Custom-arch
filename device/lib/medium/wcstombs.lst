                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module wcstombs
                                      6 	.optsdcc -mmcs51 --model-medium
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _wctomb
                                     12 	.globl _wcstombs_PARM_3
                                     13 	.globl _wcstombs_PARM_2
                                     14 	.globl _wcstombs
                                     15 ;--------------------------------------------------------
                                     16 ; special function registers
                                     17 ;--------------------------------------------------------
                                     18 	.area RSEG    (ABS,DATA)
      000000                         19 	.org 0x0000
                                     20 ;--------------------------------------------------------
                                     21 ; special function bits
                                     22 ;--------------------------------------------------------
                                     23 	.area RSEG    (ABS,DATA)
      000000                         24 	.org 0x0000
                                     25 ;--------------------------------------------------------
                                     26 ; overlayable register banks
                                     27 ;--------------------------------------------------------
                                     28 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         29 	.ds 8
                                     30 ;--------------------------------------------------------
                                     31 ; internal ram data
                                     32 ;--------------------------------------------------------
                                     33 	.area DSEG    (DATA)
                                     34 ;--------------------------------------------------------
                                     35 ; overlayable items in internal ram
                                     36 ;--------------------------------------------------------
                                     37 ;--------------------------------------------------------
                                     38 ; indirectly addressable internal ram data
                                     39 ;--------------------------------------------------------
                                     40 	.area ISEG    (DATA)
                                     41 ;--------------------------------------------------------
                                     42 ; absolute internal ram data
                                     43 ;--------------------------------------------------------
                                     44 	.area IABS    (ABS,DATA)
                                     45 	.area IABS    (ABS,DATA)
                                     46 ;--------------------------------------------------------
                                     47 ; bit data
                                     48 ;--------------------------------------------------------
                                     49 	.area BSEG    (BIT)
                                     50 ;--------------------------------------------------------
                                     51 ; paged external ram data
                                     52 ;--------------------------------------------------------
                                     53 	.area PSEG    (PAG,XDATA)
      000000                         54 _wcstombs_PARM_2:
      000000                         55 	.ds 3
      000003                         56 _wcstombs_PARM_3:
      000003                         57 	.ds 2
      000005                         58 _wcstombs_s_65536_39:
      000005                         59 	.ds 3
      000008                         60 _wcstombs_m_65536_40:
      000008                         61 	.ds 2
      00000A                         62 _wcstombs_buffer_65536_40:
      00000A                         63 	.ds 4
      00000E                         64 _wcstombs_b_131072_41:
      00000E                         65 	.ds 2
                                     66 ;--------------------------------------------------------
                                     67 ; uninitialized external ram data
                                     68 ;--------------------------------------------------------
                                     69 	.area XSEG    (XDATA)
                                     70 ;--------------------------------------------------------
                                     71 ; absolute external ram data
                                     72 ;--------------------------------------------------------
                                     73 	.area XABS    (ABS,XDATA)
                                     74 ;--------------------------------------------------------
                                     75 ; initialized external ram data
                                     76 ;--------------------------------------------------------
                                     77 	.area XISEG   (XDATA)
                                     78 	.area HOME    (CODE)
                                     79 	.area GSINIT0 (CODE)
                                     80 	.area GSINIT1 (CODE)
                                     81 	.area GSINIT2 (CODE)
                                     82 	.area GSINIT3 (CODE)
                                     83 	.area GSINIT4 (CODE)
                                     84 	.area GSINIT5 (CODE)
                                     85 	.area GSINIT  (CODE)
                                     86 	.area GSFINAL (CODE)
                                     87 	.area CSEG    (CODE)
                                     88 ;--------------------------------------------------------
                                     89 ; global & static initialisations
                                     90 ;--------------------------------------------------------
                                     91 	.area HOME    (CODE)
                                     92 	.area GSINIT  (CODE)
                                     93 	.area GSFINAL (CODE)
                                     94 	.area GSINIT  (CODE)
                                     95 ;--------------------------------------------------------
                                     96 ; Home
                                     97 ;--------------------------------------------------------
                                     98 	.area HOME    (CODE)
                                     99 	.area HOME    (CODE)
                                    100 ;--------------------------------------------------------
                                    101 ; code
                                    102 ;--------------------------------------------------------
                                    103 	.area CSEG    (CODE)
                                    104 ;------------------------------------------------------------
                                    105 ;Allocation info for local variables in function 'wcstombs'
                                    106 ;------------------------------------------------------------
                                    107 ;	wcstombs.c:33: size_t wcstombs(char *restrict s, const wchar_t *restrict pwcs, size_t n)
                                    108 ;	-----------------------------------------
                                    109 ;	 function wcstombs
                                    110 ;	-----------------------------------------
      000000                        111 _wcstombs:
                           000007   112 	ar7 = 0x07
                           000006   113 	ar6 = 0x06
                           000005   114 	ar5 = 0x05
                           000004   115 	ar4 = 0x04
                           000003   116 	ar3 = 0x03
                           000002   117 	ar2 = 0x02
                           000001   118 	ar1 = 0x01
                           000000   119 	ar0 = 0x00
      000000 AF F0            [24]  120 	mov	r7,b
      000002 AE 83            [24]  121 	mov	r6,dph
      000004 E5 82            [12]  122 	mov	a,dpl
      000006 78r05            [12]  123 	mov	r0,#_wcstombs_s_65536_39
      000008 F2               [24]  124 	movx	@r0,a
      000009 EE               [12]  125 	mov	a,r6
      00000A 08               [12]  126 	inc	r0
      00000B F2               [24]  127 	movx	@r0,a
      00000C EF               [12]  128 	mov	a,r7
      00000D 08               [12]  129 	inc	r0
      00000E F2               [24]  130 	movx	@r0,a
                                    131 ;	wcstombs.c:35: size_t m = 0;
      00000F 78r08            [12]  132 	mov	r0,#_wcstombs_m_65536_40
      000011 E4               [12]  133 	clr	a
      000012 F2               [24]  134 	movx	@r0,a
      000013 08               [12]  135 	inc	r0
      000014 F2               [24]  136 	movx	@r0,a
                                    137 ;	wcstombs.c:38: while(n > MB_LEN_MAX || n >= wctomb(buffer, *pwcs))
      000015 78r00            [12]  138 	mov	r0,#_wcstombs_PARM_2
      000017 E2               [24]  139 	movx	a,@r0
      000018 FA               [12]  140 	mov	r2,a
      000019 08               [12]  141 	inc	r0
      00001A E2               [24]  142 	movx	a,@r0
      00001B FB               [12]  143 	mov	r3,a
      00001C 08               [12]  144 	inc	r0
      00001D E2               [24]  145 	movx	a,@r0
      00001E FC               [12]  146 	mov	r4,a
      00001F                        147 00107$:
      00001F 78r03            [12]  148 	mov	r0,#_wcstombs_PARM_3
      000021 C3               [12]  149 	clr	c
      000022 E2               [24]  150 	movx	a,@r0
      000023 F5 F0            [12]  151 	mov	b,a
      000025 74 04            [12]  152 	mov	a,#0x04
      000027 95 F0            [12]  153 	subb	a,b
      000029 08               [12]  154 	inc	r0
      00002A E2               [24]  155 	movx	a,@r0
      00002B F5 F0            [12]  156 	mov	b,a
      00002D E4               [12]  157 	clr	a
      00002E 95 F0            [12]  158 	subb	a,b
      000030 40 44            [24]  159 	jc	00108$
      000032 8A 82            [24]  160 	mov	dpl,r2
      000034 8B 83            [24]  161 	mov	dph,r3
      000036 8C F0            [24]  162 	mov	b,r4
      000038 78r00            [12]  163 	mov	r0,#_wctomb_PARM_2
      00003A 12r00r00         [24]  164 	lcall	__gptrget
      00003D F2               [24]  165 	movx	@r0,a
      00003E A3               [24]  166 	inc	dptr
      00003F 12r00r00         [24]  167 	lcall	__gptrget
      000042 08               [12]  168 	inc	r0
      000043 F2               [24]  169 	movx	@r0,a
      000044 A3               [24]  170 	inc	dptr
      000045 12r00r00         [24]  171 	lcall	__gptrget
      000048 08               [12]  172 	inc	r0
      000049 F2               [24]  173 	movx	@r0,a
      00004A A3               [24]  174 	inc	dptr
      00004B 12r00r00         [24]  175 	lcall	__gptrget
      00004E 08               [12]  176 	inc	r0
      00004F F2               [24]  177 	movx	@r0,a
      000050 90r00r0A         [24]  178 	mov	dptr,#_wcstombs_buffer_65536_40
      000053 75 F0 60         [24]  179 	mov	b,#0x60
      000056 C0 04            [24]  180 	push	ar4
      000058 C0 03            [24]  181 	push	ar3
      00005A C0 02            [24]  182 	push	ar2
      00005C 12r00r00         [24]  183 	lcall	_wctomb
      00005F AE 82            [24]  184 	mov	r6,dpl
      000061 AF 83            [24]  185 	mov	r7,dph
      000063 D0 02            [24]  186 	pop	ar2
      000065 D0 03            [24]  187 	pop	ar3
      000067 D0 04            [24]  188 	pop	ar4
      000069 78r03            [12]  189 	mov	r0,#_wcstombs_PARM_3
      00006B C3               [12]  190 	clr	c
      00006C E2               [24]  191 	movx	a,@r0
      00006D 9E               [12]  192 	subb	a,r6
      00006E 08               [12]  193 	inc	r0
      00006F E2               [24]  194 	movx	a,@r0
      000070 9F               [12]  195 	subb	a,r7
      000071 50 03            [24]  196 	jnc	00129$
      000073 02r01r19         [24]  197 	ljmp	00109$
      000076                        198 00129$:
      000076                        199 00108$:
                                    200 ;	wcstombs.c:40: int b = wctomb(s, *pwcs);
      000076 8A 82            [24]  201 	mov	dpl,r2
      000078 8B 83            [24]  202 	mov	dph,r3
      00007A 8C F0            [24]  203 	mov	b,r4
      00007C 78r00            [12]  204 	mov	r0,#_wctomb_PARM_2
      00007E 12r00r00         [24]  205 	lcall	__gptrget
      000081 F2               [24]  206 	movx	@r0,a
      000082 A3               [24]  207 	inc	dptr
      000083 12r00r00         [24]  208 	lcall	__gptrget
      000086 08               [12]  209 	inc	r0
      000087 F2               [24]  210 	movx	@r0,a
      000088 A3               [24]  211 	inc	dptr
      000089 12r00r00         [24]  212 	lcall	__gptrget
      00008C 08               [12]  213 	inc	r0
      00008D F2               [24]  214 	movx	@r0,a
      00008E A3               [24]  215 	inc	dptr
      00008F 12r00r00         [24]  216 	lcall	__gptrget
      000092 08               [12]  217 	inc	r0
      000093 F2               [24]  218 	movx	@r0,a
      000094 78r05            [12]  219 	mov	r0,#_wcstombs_s_65536_39
      000096 E2               [24]  220 	movx	a,@r0
      000097 F5 82            [12]  221 	mov	dpl,a
      000099 08               [12]  222 	inc	r0
      00009A E2               [24]  223 	movx	a,@r0
      00009B F5 83            [12]  224 	mov	dph,a
      00009D 08               [12]  225 	inc	r0
      00009E E2               [24]  226 	movx	a,@r0
      00009F F5 F0            [12]  227 	mov	b,a
      0000A1 C0 04            [24]  228 	push	ar4
      0000A3 C0 03            [24]  229 	push	ar3
      0000A5 C0 02            [24]  230 	push	ar2
      0000A7 12r00r00         [24]  231 	lcall	_wctomb
      0000AA 78r0E            [12]  232 	mov	r0,#_wcstombs_b_131072_41
      0000AC E5 82            [12]  233 	mov	a,dpl
      0000AE F2               [24]  234 	movx	@r0,a
      0000AF E5 83            [12]  235 	mov	a,dph
      0000B1 08               [12]  236 	inc	r0
      0000B2 F2               [24]  237 	movx	@r0,a
      0000B3 D0 02            [24]  238 	pop	ar2
      0000B5 D0 03            [24]  239 	pop	ar3
      0000B7 D0 04            [24]  240 	pop	ar4
                                    241 ;	wcstombs.c:42: if(b == 1 && !*s)
      0000B9 78r0E            [12]  242 	mov	r0,#_wcstombs_b_131072_41
      0000BB E2               [24]  243 	movx	a,@r0
      0000BC B4 01 04         [24]  244 	cjne	a,#0x01,00130$
      0000BF 08               [12]  245 	inc	r0
      0000C0 E2               [24]  246 	movx	a,@r0
      0000C1 60 02            [24]  247 	jz	00131$
      0000C3                        248 00130$:
      0000C3 80 12            [24]  249 	sjmp	00102$
      0000C5                        250 00131$:
      0000C5 78r05            [12]  251 	mov	r0,#_wcstombs_s_65536_39
      0000C7 E2               [24]  252 	movx	a,@r0
      0000C8 F5 82            [12]  253 	mov	dpl,a
      0000CA 08               [12]  254 	inc	r0
      0000CB E2               [24]  255 	movx	a,@r0
      0000CC F5 83            [12]  256 	mov	dph,a
      0000CE 08               [12]  257 	inc	r0
      0000CF E2               [24]  258 	movx	a,@r0
      0000D0 F5 F0            [12]  259 	mov	b,a
      0000D2 12r00r00         [24]  260 	lcall	__gptrget
      0000D5 60 42            [24]  261 	jz	00109$
                                    262 ;	wcstombs.c:43: break;
      0000D7                        263 00102$:
                                    264 ;	wcstombs.c:44: if(b < 0)
      0000D7 78r0F            [12]  265 	mov	r0,#(_wcstombs_b_131072_41 + 1)
      0000D9 E2               [24]  266 	movx	a,@r0
      0000DA 30 E7 04         [24]  267 	jnb	acc.7,00105$
                                    268 ;	wcstombs.c:45: return(-1);
      0000DD 90 FF FF         [24]  269 	mov	dptr,#0xffff
      0000E0 22               [24]  270 	ret
      0000E1                        271 00105$:
                                    272 ;	wcstombs.c:47: n -= b;
      0000E1 78r0E            [12]  273 	mov	r0,#_wcstombs_b_131072_41
      0000E3 E2               [24]  274 	movx	a,@r0
      0000E4 FD               [12]  275 	mov	r5,a
      0000E5 08               [12]  276 	inc	r0
      0000E6 E2               [24]  277 	movx	a,@r0
      0000E7 FF               [12]  278 	mov	r7,a
      0000E8 78r03            [12]  279 	mov	r0,#_wcstombs_PARM_3
      0000EA E2               [24]  280 	movx	a,@r0
      0000EB C3               [12]  281 	clr	c
      0000EC 9D               [12]  282 	subb	a,r5
      0000ED F2               [24]  283 	movx	@r0,a
      0000EE 08               [12]  284 	inc	r0
      0000EF E2               [24]  285 	movx	a,@r0
      0000F0 9F               [12]  286 	subb	a,r7
      0000F1 F2               [24]  287 	movx	@r0,a
                                    288 ;	wcstombs.c:48: m += b;
      0000F2 78r08            [12]  289 	mov	r0,#_wcstombs_m_65536_40
      0000F4 E2               [24]  290 	movx	a,@r0
      0000F5 2D               [12]  291 	add	a,r5
      0000F6 F2               [24]  292 	movx	@r0,a
      0000F7 08               [12]  293 	inc	r0
      0000F8 E2               [24]  294 	movx	a,@r0
      0000F9 3F               [12]  295 	addc	a,r7
      0000FA F2               [24]  296 	movx	@r0,a
                                    297 ;	wcstombs.c:49: s += b;
      0000FB 78r05            [12]  298 	mov	r0,#_wcstombs_s_65536_39
      0000FD 79r0E            [12]  299 	mov	r1,#_wcstombs_b_131072_41
      0000FF E3               [24]  300 	movx	a,@r1
      000100 C5 F0            [12]  301 	xch	a,b
      000102 E2               [24]  302 	movx	a,@r0
      000103 25 F0            [12]  303 	add	a,b
      000105 F2               [24]  304 	movx	@r0,a
      000106 09               [12]  305 	inc	r1
      000107 E3               [24]  306 	movx	a,@r1
      000108 C5 F0            [12]  307 	xch	a,b
      00010A 08               [12]  308 	inc	r0
      00010B E2               [24]  309 	movx	a,@r0
      00010C 35 F0            [12]  310 	addc	a,b
      00010E F2               [24]  311 	movx	@r0,a
                                    312 ;	wcstombs.c:50: pwcs++;
      00010F 74 04            [12]  313 	mov	a,#0x04
      000111 2A               [12]  314 	add	a,r2
      000112 FA               [12]  315 	mov	r2,a
      000113 E4               [12]  316 	clr	a
      000114 3B               [12]  317 	addc	a,r3
      000115 FB               [12]  318 	mov	r3,a
      000116 02r00r1F         [24]  319 	ljmp	00107$
      000119                        320 00109$:
                                    321 ;	wcstombs.c:53: return(m);
      000119 78r08            [12]  322 	mov	r0,#_wcstombs_m_65536_40
      00011B E2               [24]  323 	movx	a,@r0
      00011C F5 82            [12]  324 	mov	dpl,a
      00011E 08               [12]  325 	inc	r0
      00011F E2               [24]  326 	movx	a,@r0
      000120 F5 83            [12]  327 	mov	dph,a
                                    328 ;	wcstombs.c:54: }
      000122 22               [24]  329 	ret
                                    330 	.area CSEG    (CODE)
                                    331 	.area CONST   (CODE)
                                    332 	.area XINIT   (CODE)
                                    333 	.area CABS    (ABS,CODE)

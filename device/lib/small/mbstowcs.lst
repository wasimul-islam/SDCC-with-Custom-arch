                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module mbstowcs
                                      6 	.optsdcc -mmcs51 --model-small
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _mbtowc
                                     12 	.globl _mbstowcs_PARM_3
                                     13 	.globl _mbstowcs_PARM_2
                                     14 	.globl _mbstowcs
                                     15 ;--------------------------------------------------------
                                     16 ; special function registers
                                     17 ;--------------------------------------------------------
                                     18 	.area RSEG    (ABS,DATA)
      000000                         19 	.org 0x0000
                                     20 ;--------------------------------------------------------
                                     21 ; special function bits
                                     22 ;--------------------------------------------------------
                                     23 	.area RSEG    (ABS,DATA)
      000000                         24 	.org 0x0000
                                     25 ;--------------------------------------------------------
                                     26 ; overlayable register banks
                                     27 ;--------------------------------------------------------
                                     28 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         29 	.ds 8
                                     30 ;--------------------------------------------------------
                                     31 ; internal ram data
                                     32 ;--------------------------------------------------------
                                     33 	.area DSEG    (DATA)
      000000                         34 _mbstowcs_PARM_2:
      000000                         35 	.ds 3
      000003                         36 _mbstowcs_PARM_3:
      000003                         37 	.ds 2
      000005                         38 _mbstowcs_m_65536_40:
      000005                         39 	.ds 2
      000007                         40 _mbstowcs_sloc0_1_0:
      000007                         41 	.ds 2
                                     42 ;--------------------------------------------------------
                                     43 ; overlayable items in internal ram
                                     44 ;--------------------------------------------------------
                                     45 ;--------------------------------------------------------
                                     46 ; indirectly addressable internal ram data
                                     47 ;--------------------------------------------------------
                                     48 	.area ISEG    (DATA)
                                     49 ;--------------------------------------------------------
                                     50 ; absolute internal ram data
                                     51 ;--------------------------------------------------------
                                     52 	.area IABS    (ABS,DATA)
                                     53 	.area IABS    (ABS,DATA)
                                     54 ;--------------------------------------------------------
                                     55 ; bit data
                                     56 ;--------------------------------------------------------
                                     57 	.area BSEG    (BIT)
                                     58 ;--------------------------------------------------------
                                     59 ; paged external ram data
                                     60 ;--------------------------------------------------------
                                     61 	.area PSEG    (PAG,XDATA)
                                     62 ;--------------------------------------------------------
                                     63 ; uninitialized external ram data
                                     64 ;--------------------------------------------------------
                                     65 	.area XSEG    (XDATA)
                                     66 ;--------------------------------------------------------
                                     67 ; absolute external ram data
                                     68 ;--------------------------------------------------------
                                     69 	.area XABS    (ABS,XDATA)
                                     70 ;--------------------------------------------------------
                                     71 ; initialized external ram data
                                     72 ;--------------------------------------------------------
                                     73 	.area XISEG   (XDATA)
                                     74 	.area HOME    (CODE)
                                     75 	.area GSINIT0 (CODE)
                                     76 	.area GSINIT1 (CODE)
                                     77 	.area GSINIT2 (CODE)
                                     78 	.area GSINIT3 (CODE)
                                     79 	.area GSINIT4 (CODE)
                                     80 	.area GSINIT5 (CODE)
                                     81 	.area GSINIT  (CODE)
                                     82 	.area GSFINAL (CODE)
                                     83 	.area CSEG    (CODE)
                                     84 ;--------------------------------------------------------
                                     85 ; global & static initialisations
                                     86 ;--------------------------------------------------------
                                     87 	.area HOME    (CODE)
                                     88 	.area GSINIT  (CODE)
                                     89 	.area GSFINAL (CODE)
                                     90 	.area GSINIT  (CODE)
                                     91 ;--------------------------------------------------------
                                     92 ; Home
                                     93 ;--------------------------------------------------------
                                     94 	.area HOME    (CODE)
                                     95 	.area HOME    (CODE)
                                     96 ;--------------------------------------------------------
                                     97 ; code
                                     98 ;--------------------------------------------------------
                                     99 	.area CSEG    (CODE)
                                    100 ;------------------------------------------------------------
                                    101 ;Allocation info for local variables in function 'mbstowcs'
                                    102 ;------------------------------------------------------------
                                    103 ;s                         Allocated with name '_mbstowcs_PARM_2'
                                    104 ;n                         Allocated with name '_mbstowcs_PARM_3'
                                    105 ;pwcs                      Allocated to registers 
                                    106 ;m                         Allocated with name '_mbstowcs_m_65536_40'
                                    107 ;b                         Allocated to registers r1 r2 
                                    108 ;sloc0                     Allocated with name '_mbstowcs_sloc0_1_0'
                                    109 ;------------------------------------------------------------
                                    110 ;	mbstowcs.c:33: size_t mbstowcs(wchar_t *restrict pwcs, const char *restrict s, size_t n)
                                    111 ;	-----------------------------------------
                                    112 ;	 function mbstowcs
                                    113 ;	-----------------------------------------
      000000                        114 _mbstowcs:
                           000007   115 	ar7 = 0x07
                           000006   116 	ar6 = 0x06
                           000005   117 	ar5 = 0x05
                           000004   118 	ar4 = 0x04
                           000003   119 	ar3 = 0x03
                           000002   120 	ar2 = 0x02
                           000001   121 	ar1 = 0x01
                           000000   122 	ar0 = 0x00
      000000 AD 82            [24]  123 	mov	r5,dpl
      000002 AE 83            [24]  124 	mov	r6,dph
      000004 AF F0            [24]  125 	mov	r7,b
                                    126 ;	mbstowcs.c:35: size_t m = 0;
                                    127 ;	mbstowcs.c:36: while(n--)
      000006 E4               [12]  128 	clr	a
      000007 FB               [12]  129 	mov	r3,a
      000008 FC               [12]  130 	mov	r4,a
      000009 F5*05            [12]  131 	mov	_mbstowcs_m_65536_40,a
      00000B F5*06            [12]  132 	mov	(_mbstowcs_m_65536_40 + 1),a
      00000D 85*03*07         [24]  133 	mov	_mbstowcs_sloc0_1_0,_mbstowcs_PARM_3
      000010 85*04*08         [24]  134 	mov	(_mbstowcs_sloc0_1_0 + 1),(_mbstowcs_PARM_3 + 1)
      000013                        135 00105$:
      000013 A8*07            [24]  136 	mov	r0,_mbstowcs_sloc0_1_0
      000015 AA*08            [24]  137 	mov	r2,(_mbstowcs_sloc0_1_0 + 1)
      000017 15*07            [12]  138 	dec	_mbstowcs_sloc0_1_0
      000019 74 FF            [12]  139 	mov	a,#0xff
      00001B B5*07 02         [24]  140 	cjne	a,_mbstowcs_sloc0_1_0,00126$
      00001E 15*08            [12]  141 	dec	(_mbstowcs_sloc0_1_0 + 1)
      000020                        142 00126$:
      000020 E8               [12]  143 	mov	a,r0
      000021 4A               [12]  144 	orl	a,r2
      000022 60 61            [24]  145 	jz	00107$
                                    146 ;	mbstowcs.c:38: int b = mbtowc(pwcs++, s, MB_LEN_MAX);
      000024 8D 00            [24]  147 	mov	ar0,r5
      000026 8E 01            [24]  148 	mov	ar1,r6
      000028 8F 02            [24]  149 	mov	ar2,r7
      00002A 74 04            [12]  150 	mov	a,#0x04
      00002C 2D               [12]  151 	add	a,r5
      00002D FD               [12]  152 	mov	r5,a
      00002E E4               [12]  153 	clr	a
      00002F 3E               [12]  154 	addc	a,r6
      000030 FE               [12]  155 	mov	r6,a
      000031 85*00*00         [24]  156 	mov	_mbtowc_PARM_2,_mbstowcs_PARM_2
      000034 85*01*01         [24]  157 	mov	(_mbtowc_PARM_2 + 1),(_mbstowcs_PARM_2 + 1)
      000037 85*02*02         [24]  158 	mov	(_mbtowc_PARM_2 + 2),(_mbstowcs_PARM_2 + 2)
      00003A 75*00 04         [24]  159 	mov	_mbtowc_PARM_3,#0x04
      00003D 75*01 00         [24]  160 	mov	(_mbtowc_PARM_3 + 1),#0x00
      000040 88 82            [24]  161 	mov	dpl,r0
      000042 89 83            [24]  162 	mov	dph,r1
      000044 8A F0            [24]  163 	mov	b,r2
      000046 C0 07            [24]  164 	push	ar7
      000048 C0 06            [24]  165 	push	ar6
      00004A C0 05            [24]  166 	push	ar5
      00004C C0 04            [24]  167 	push	ar4
      00004E C0 03            [24]  168 	push	ar3
      000050 12r00r00         [24]  169 	lcall	_mbtowc
      000053 A9 82            [24]  170 	mov	r1,dpl
      000055 AA 83            [24]  171 	mov	r2,dph
      000057 D0 03            [24]  172 	pop	ar3
      000059 D0 04            [24]  173 	pop	ar4
      00005B D0 05            [24]  174 	pop	ar5
      00005D D0 06            [24]  175 	pop	ar6
      00005F D0 07            [24]  176 	pop	ar7
                                    177 ;	mbstowcs.c:39: if(!b)
      000061 E9               [12]  178 	mov	a,r1
      000062 4A               [12]  179 	orl	a,r2
      000063 60 20            [24]  180 	jz	00107$
                                    181 ;	mbstowcs.c:41: if(b < 0)
      000065 EA               [12]  182 	mov	a,r2
      000066 30 E7 04         [24]  183 	jnb	acc.7,00104$
                                    184 ;	mbstowcs.c:42: return(-1);
      000069 90 FF FF         [24]  185 	mov	dptr,#0xffff
      00006C 22               [24]  186 	ret
      00006D                        187 00104$:
                                    188 ;	mbstowcs.c:43: s += b;
      00006D E9               [12]  189 	mov	a,r1
      00006E 25*00            [12]  190 	add	a,_mbstowcs_PARM_2
      000070 F5*00            [12]  191 	mov	_mbstowcs_PARM_2,a
      000072 EA               [12]  192 	mov	a,r2
      000073 35*01            [12]  193 	addc	a,(_mbstowcs_PARM_2 + 1)
      000075 F5*01            [12]  194 	mov	(_mbstowcs_PARM_2 + 1),a
                                    195 ;	mbstowcs.c:44: m++;
      000077 05*05            [12]  196 	inc	_mbstowcs_m_65536_40
      000079 E4               [12]  197 	clr	a
      00007A B5*05 02         [24]  198 	cjne	a,_mbstowcs_m_65536_40,00130$
      00007D 05*06            [12]  199 	inc	(_mbstowcs_m_65536_40 + 1)
      00007F                        200 00130$:
      00007F AB*05            [24]  201 	mov	r3,_mbstowcs_m_65536_40
      000081 AC*06            [24]  202 	mov	r4,(_mbstowcs_m_65536_40 + 1)
      000083 80 8E            [24]  203 	sjmp	00105$
      000085                        204 00107$:
                                    205 ;	mbstowcs.c:47: return(m);
      000085 8B 82            [24]  206 	mov	dpl,r3
      000087 8C 83            [24]  207 	mov	dph,r4
                                    208 ;	mbstowcs.c:48: }
      000089 22               [24]  209 	ret
                                    210 	.area CSEG    (CODE)
                                    211 	.area CONST   (CODE)
                                    212 	.area XINIT   (CODE)
                                    213 	.area CABS    (ABS,CODE)

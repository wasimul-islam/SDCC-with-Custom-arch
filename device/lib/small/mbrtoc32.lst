                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module mbrtoc32
                                      6 	.optsdcc -mmcs51 --model-small
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _mbrtowc
                                     12 	.globl _mbrtoc32_PARM_4
                                     13 	.globl _mbrtoc32_PARM_3
                                     14 	.globl _mbrtoc32_PARM_2
                                     15 	.globl _mbrtoc32
                                     16 ;--------------------------------------------------------
                                     17 ; special function registers
                                     18 ;--------------------------------------------------------
                                     19 	.area RSEG    (ABS,DATA)
      000000                         20 	.org 0x0000
                                     21 ;--------------------------------------------------------
                                     22 ; special function bits
                                     23 ;--------------------------------------------------------
                                     24 	.area RSEG    (ABS,DATA)
      000000                         25 	.org 0x0000
                                     26 ;--------------------------------------------------------
                                     27 ; overlayable register banks
                                     28 ;--------------------------------------------------------
                                     29 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         30 	.ds 8
                                     31 ;--------------------------------------------------------
                                     32 ; internal ram data
                                     33 ;--------------------------------------------------------
                                     34 	.area DSEG    (DATA)
      000000                         35 _mbrtoc32_sps_65536_16:
      000000                         36 	.ds 3
      000003                         37 _mbrtoc32_PARM_2:
      000003                         38 	.ds 3
      000006                         39 _mbrtoc32_PARM_3:
      000006                         40 	.ds 2
      000008                         41 _mbrtoc32_PARM_4:
      000008                         42 	.ds 3
      00000B                         43 _mbrtoc32_wc_65536_16:
      00000B                         44 	.ds 4
                                     45 ;--------------------------------------------------------
                                     46 ; overlayable items in internal ram
                                     47 ;--------------------------------------------------------
                                     48 ;--------------------------------------------------------
                                     49 ; indirectly addressable internal ram data
                                     50 ;--------------------------------------------------------
                                     51 	.area ISEG    (DATA)
                                     52 ;--------------------------------------------------------
                                     53 ; absolute internal ram data
                                     54 ;--------------------------------------------------------
                                     55 	.area IABS    (ABS,DATA)
                                     56 	.area IABS    (ABS,DATA)
                                     57 ;--------------------------------------------------------
                                     58 ; bit data
                                     59 ;--------------------------------------------------------
                                     60 	.area BSEG    (BIT)
                                     61 ;--------------------------------------------------------
                                     62 ; paged external ram data
                                     63 ;--------------------------------------------------------
                                     64 	.area PSEG    (PAG,XDATA)
                                     65 ;--------------------------------------------------------
                                     66 ; uninitialized external ram data
                                     67 ;--------------------------------------------------------
                                     68 	.area XSEG    (XDATA)
                                     69 ;--------------------------------------------------------
                                     70 ; absolute external ram data
                                     71 ;--------------------------------------------------------
                                     72 	.area XABS    (ABS,XDATA)
                                     73 ;--------------------------------------------------------
                                     74 ; initialized external ram data
                                     75 ;--------------------------------------------------------
                                     76 	.area XISEG   (XDATA)
                                     77 	.area HOME    (CODE)
                                     78 	.area GSINIT0 (CODE)
                                     79 	.area GSINIT1 (CODE)
                                     80 	.area GSINIT2 (CODE)
                                     81 	.area GSINIT3 (CODE)
                                     82 	.area GSINIT4 (CODE)
                                     83 	.area GSINIT5 (CODE)
                                     84 	.area GSINIT  (CODE)
                                     85 	.area GSFINAL (CODE)
                                     86 	.area CSEG    (CODE)
                                     87 ;--------------------------------------------------------
                                     88 ; global & static initialisations
                                     89 ;--------------------------------------------------------
                                     90 	.area HOME    (CODE)
                                     91 	.area GSINIT  (CODE)
                                     92 	.area GSFINAL (CODE)
                                     93 	.area GSINIT  (CODE)
                                     94 ;--------------------------------------------------------
                                     95 ; Home
                                     96 ;--------------------------------------------------------
                                     97 	.area HOME    (CODE)
                                     98 	.area HOME    (CODE)
                                     99 ;--------------------------------------------------------
                                    100 ; code
                                    101 ;--------------------------------------------------------
                                    102 	.area CSEG    (CODE)
                                    103 ;------------------------------------------------------------
                                    104 ;Allocation info for local variables in function 'mbrtoc32'
                                    105 ;------------------------------------------------------------
                                    106 ;sps                       Allocated with name '_mbrtoc32_sps_65536_16'
                                    107 ;s                         Allocated with name '_mbrtoc32_PARM_2'
                                    108 ;n                         Allocated with name '_mbrtoc32_PARM_3'
                                    109 ;ps                        Allocated with name '_mbrtoc32_PARM_4'
                                    110 ;pc32                      Allocated to registers r5 r6 r7 
                                    111 ;wc                        Allocated with name '_mbrtoc32_wc_65536_16'
                                    112 ;ret                       Allocated to registers r3 r4 
                                    113 ;------------------------------------------------------------
                                    114 ;	mbrtoc32.c:34: size_t mbrtoc32(char32_t *restrict pc32, const char *restrict s, size_t n, mbstate_t *restrict ps)
                                    115 ;	-----------------------------------------
                                    116 ;	 function mbrtoc32
                                    117 ;	-----------------------------------------
      000000                        118 _mbrtoc32:
                           000007   119 	ar7 = 0x07
                           000006   120 	ar6 = 0x06
                           000005   121 	ar5 = 0x05
                           000004   122 	ar4 = 0x04
                           000003   123 	ar3 = 0x03
                           000002   124 	ar2 = 0x02
                           000001   125 	ar1 = 0x01
                           000000   126 	ar0 = 0x00
      000000 AD 82            [24]  127 	mov	r5,dpl
      000002 AE 83            [24]  128 	mov	r6,dph
      000004 AF F0            [24]  129 	mov	r7,b
                                    130 ;	mbrtoc32.c:40: if(!ps)
      000006 E5*08            [12]  131 	mov	a,_mbrtoc32_PARM_4
      000008 45*09            [12]  132 	orl	a,(_mbrtoc32_PARM_4 + 1)
                                    133 ;	mbrtoc32.c:41: ps = &sps;
      00000A 70 08            [24]  134 	jnz	00102$
      00000C 75*08r00         [24]  135 	mov	_mbrtoc32_PARM_4,#_mbrtoc32_sps_65536_16
      00000F F5*09            [12]  136 	mov	(_mbrtoc32_PARM_4 + 1),a
      000011 75*0A 40         [24]  137 	mov	(_mbrtoc32_PARM_4 + 2),#0x40
      000014                        138 00102$:
                                    139 ;	mbrtoc32.c:43: if(!pc32)
      000014 ED               [12]  140 	mov	a,r5
      000015 4E               [12]  141 	orl	a,r6
      000016 70 21            [24]  142 	jnz	00104$
                                    143 ;	mbrtoc32.c:44: return(mbrtowc(0, s, n, ps));
      000018 85*03*00         [24]  144 	mov	_mbrtowc_PARM_2,_mbrtoc32_PARM_2
      00001B 85*04*01         [24]  145 	mov	(_mbrtowc_PARM_2 + 1),(_mbrtoc32_PARM_2 + 1)
      00001E 85*05*02         [24]  146 	mov	(_mbrtowc_PARM_2 + 2),(_mbrtoc32_PARM_2 + 2)
      000021 85*06*00         [24]  147 	mov	_mbrtowc_PARM_3,_mbrtoc32_PARM_3
      000024 85*07*01         [24]  148 	mov	(_mbrtowc_PARM_3 + 1),(_mbrtoc32_PARM_3 + 1)
      000027 85*08*00         [24]  149 	mov	_mbrtowc_PARM_4,_mbrtoc32_PARM_4
      00002A 85*09*01         [24]  150 	mov	(_mbrtowc_PARM_4 + 1),(_mbrtoc32_PARM_4 + 1)
      00002D 85*0A*02         [24]  151 	mov	(_mbrtowc_PARM_4 + 2),(_mbrtoc32_PARM_4 + 2)
      000030 90 00 00         [24]  152 	mov	dptr,#0x0000
      000033 75 F0 00         [24]  153 	mov	b,#0x00
      000036 02r00r00         [24]  154 	ljmp	_mbrtowc
      000039                        155 00104$:
                                    156 ;	mbrtoc32.c:46: ret = mbrtowc(&wc, s, n, ps);
      000039 85*03*00         [24]  157 	mov	_mbrtowc_PARM_2,_mbrtoc32_PARM_2
      00003C 85*04*01         [24]  158 	mov	(_mbrtowc_PARM_2 + 1),(_mbrtoc32_PARM_2 + 1)
      00003F 85*05*02         [24]  159 	mov	(_mbrtowc_PARM_2 + 2),(_mbrtoc32_PARM_2 + 2)
      000042 85*06*00         [24]  160 	mov	_mbrtowc_PARM_3,_mbrtoc32_PARM_3
      000045 85*07*01         [24]  161 	mov	(_mbrtowc_PARM_3 + 1),(_mbrtoc32_PARM_3 + 1)
      000048 85*08*00         [24]  162 	mov	_mbrtowc_PARM_4,_mbrtoc32_PARM_4
      00004B 85*09*01         [24]  163 	mov	(_mbrtowc_PARM_4 + 1),(_mbrtoc32_PARM_4 + 1)
      00004E 85*0A*02         [24]  164 	mov	(_mbrtowc_PARM_4 + 2),(_mbrtoc32_PARM_4 + 2)
      000051 90r00r0B         [24]  165 	mov	dptr,#_mbrtoc32_wc_65536_16
      000054 75 F0 40         [24]  166 	mov	b,#0x40
      000057 C0 07            [24]  167 	push	ar7
      000059 C0 06            [24]  168 	push	ar6
      00005B C0 05            [24]  169 	push	ar5
      00005D 12r00r00         [24]  170 	lcall	_mbrtowc
      000060 AB 82            [24]  171 	mov	r3,dpl
      000062 AC 83            [24]  172 	mov	r4,dph
      000064 D0 05            [24]  173 	pop	ar5
      000066 D0 06            [24]  174 	pop	ar6
      000068 D0 07            [24]  175 	pop	ar7
                                    176 ;	mbrtoc32.c:48: if(ret <= MB_LEN_MAX)
      00006A C3               [12]  177 	clr	c
      00006B 74 04            [12]  178 	mov	a,#0x04
      00006D 9B               [12]  179 	subb	a,r3
      00006E E4               [12]  180 	clr	a
      00006F 9C               [12]  181 	subb	a,r4
      000070 40 1D            [24]  182 	jc	00106$
                                    183 ;	mbrtoc32.c:49: *pc32 = wc;
      000072 8D 82            [24]  184 	mov	dpl,r5
      000074 8E 83            [24]  185 	mov	dph,r6
      000076 8F F0            [24]  186 	mov	b,r7
      000078 E5*0B            [12]  187 	mov	a,_mbrtoc32_wc_65536_16
      00007A 12r00r00         [24]  188 	lcall	__gptrput
      00007D A3               [24]  189 	inc	dptr
      00007E E5*0C            [12]  190 	mov	a,(_mbrtoc32_wc_65536_16 + 1)
      000080 12r00r00         [24]  191 	lcall	__gptrput
      000083 A3               [24]  192 	inc	dptr
      000084 E5*0D            [12]  193 	mov	a,(_mbrtoc32_wc_65536_16 + 2)
      000086 12r00r00         [24]  194 	lcall	__gptrput
      000089 A3               [24]  195 	inc	dptr
      00008A E5*0E            [12]  196 	mov	a,(_mbrtoc32_wc_65536_16 + 3)
      00008C 12r00r00         [24]  197 	lcall	__gptrput
      00008F                        198 00106$:
                                    199 ;	mbrtoc32.c:51: return(ret);
      00008F 8B 82            [24]  200 	mov	dpl,r3
      000091 8C 83            [24]  201 	mov	dph,r4
                                    202 ;	mbrtoc32.c:52: }
      000093 22               [24]  203 	ret
                                    204 	.area CSEG    (CODE)
                                    205 	.area CONST   (CODE)
                                    206 	.area XINIT   (CODE)
                                    207 	.area CABS    (ABS,CODE)

                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.2.14 #0 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module wcstombs
                                      6 	.optsdcc -mmcs51 --model-huge
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _wctomb
                                     12 	.globl _wcstombs_PARM_3
                                     13 	.globl _wcstombs_PARM_2
                                     14 	.globl _wcstombs
                                     15 ;--------------------------------------------------------
                                     16 ; special function registers
                                     17 ;--------------------------------------------------------
                                     18 	.area RSEG    (ABS,DATA)
      000000                         19 	.org 0x0000
                                     20 ;--------------------------------------------------------
                                     21 ; special function bits
                                     22 ;--------------------------------------------------------
                                     23 	.area RSEG    (ABS,DATA)
      000000                         24 	.org 0x0000
                                     25 ;--------------------------------------------------------
                                     26 ; overlayable register banks
                                     27 ;--------------------------------------------------------
                                     28 	.area REG_BANK_0	(REL,OVR,DATA)
      000000                         29 	.ds 8
                                     30 ;--------------------------------------------------------
                                     31 ; internal ram data
                                     32 ;--------------------------------------------------------
                                     33 	.area DSEG    (DATA)
      000000                         34 _wcstombs_sloc0_1_0:
      000000                         35 	.ds 2
      000002                         36 _wcstombs_sloc1_1_0:
      000002                         37 	.ds 3
                                     38 ;--------------------------------------------------------
                                     39 ; overlayable items in internal ram
                                     40 ;--------------------------------------------------------
                                     41 ;--------------------------------------------------------
                                     42 ; indirectly addressable internal ram data
                                     43 ;--------------------------------------------------------
                                     44 	.area ISEG    (DATA)
                                     45 ;--------------------------------------------------------
                                     46 ; absolute internal ram data
                                     47 ;--------------------------------------------------------
                                     48 	.area IABS    (ABS,DATA)
                                     49 	.area IABS    (ABS,DATA)
                                     50 ;--------------------------------------------------------
                                     51 ; bit data
                                     52 ;--------------------------------------------------------
                                     53 	.area BSEG    (BIT)
                                     54 ;--------------------------------------------------------
                                     55 ; paged external ram data
                                     56 ;--------------------------------------------------------
                                     57 	.area PSEG    (PAG,XDATA)
                                     58 ;--------------------------------------------------------
                                     59 ; uninitialized external ram data
                                     60 ;--------------------------------------------------------
                                     61 	.area XSEG    (XDATA)
      000000                         62 _wcstombs_PARM_2:
      000000                         63 	.ds 3
      000003                         64 _wcstombs_PARM_3:
      000003                         65 	.ds 2
      000005                         66 _wcstombs_s_65536_39:
      000005                         67 	.ds 3
      000008                         68 _wcstombs_m_65536_40:
      000008                         69 	.ds 2
      00000A                         70 _wcstombs_buffer_65536_40:
      00000A                         71 	.ds 4
                                     72 ;--------------------------------------------------------
                                     73 ; absolute external ram data
                                     74 ;--------------------------------------------------------
                                     75 	.area XABS    (ABS,XDATA)
                                     76 ;--------------------------------------------------------
                                     77 ; initialized external ram data
                                     78 ;--------------------------------------------------------
                                     79 	.area XISEG   (XDATA)
                                     80 	.area HOME    (CODE)
                                     81 	.area GSINIT0 (CODE)
                                     82 	.area GSINIT1 (CODE)
                                     83 	.area GSINIT2 (CODE)
                                     84 	.area GSINIT3 (CODE)
                                     85 	.area GSINIT4 (CODE)
                                     86 	.area GSINIT5 (CODE)
                                     87 	.area GSINIT  (CODE)
                                     88 	.area GSFINAL (CODE)
                                     89 	.area CSEG    (CODE)
                                     90 ;--------------------------------------------------------
                                     91 ; global & static initialisations
                                     92 ;--------------------------------------------------------
                                     93 	.area HOME    (CODE)
                                     94 	.area GSINIT  (CODE)
                                     95 	.area GSFINAL (CODE)
                                     96 	.area GSINIT  (CODE)
                                     97 ;--------------------------------------------------------
                                     98 ; Home
                                     99 ;--------------------------------------------------------
                                    100 	.area HOME    (CODE)
                                    101 	.area HOME    (CODE)
                                    102 ;--------------------------------------------------------
                                    103 ; code
                                    104 ;--------------------------------------------------------
                                    105 	.area CSEG    (CODE)
                                    106 ;------------------------------------------------------------
                                    107 ;Allocation info for local variables in function 'wcstombs'
                                    108 ;------------------------------------------------------------
                                    109 ;sloc0                     Allocated with name '_wcstombs_sloc0_1_0'
                                    110 ;sloc1                     Allocated with name '_wcstombs_sloc1_1_0'
                                    111 ;pwcs                      Allocated with name '_wcstombs_PARM_2'
                                    112 ;n                         Allocated with name '_wcstombs_PARM_3'
                                    113 ;s                         Allocated with name '_wcstombs_s_65536_39'
                                    114 ;m                         Allocated with name '_wcstombs_m_65536_40'
                                    115 ;buffer                    Allocated with name '_wcstombs_buffer_65536_40'
                                    116 ;b                         Allocated with name '_wcstombs_b_131072_41'
                                    117 ;------------------------------------------------------------
                                    118 ;	wcstombs.c:33: size_t wcstombs(char *restrict s, const wchar_t *restrict pwcs, size_t n)
                                    119 ;	-----------------------------------------
                                    120 ;	 function wcstombs
                                    121 ;	-----------------------------------------
      000000                        122 _wcstombs:
                           000007   123 	ar7 = 0x07
                           000006   124 	ar6 = 0x06
                           000005   125 	ar5 = 0x05
                           000004   126 	ar4 = 0x04
                           000003   127 	ar3 = 0x03
                           000002   128 	ar2 = 0x02
                           000001   129 	ar1 = 0x01
                           000000   130 	ar0 = 0x00
      000000 AF F0            [24]  131 	mov	r7,b
      000002 AE 83            [24]  132 	mov	r6,dph
      000004 E5 82            [12]  133 	mov	a,dpl
      000006 90r00r05         [24]  134 	mov	dptr,#_wcstombs_s_65536_39
      000009 F0               [24]  135 	movx	@dptr,a
      00000A EE               [12]  136 	mov	a,r6
      00000B A3               [24]  137 	inc	dptr
      00000C F0               [24]  138 	movx	@dptr,a
      00000D EF               [12]  139 	mov	a,r7
      00000E A3               [24]  140 	inc	dptr
      00000F F0               [24]  141 	movx	@dptr,a
                                    142 ;	wcstombs.c:35: size_t m = 0;
      000010 90r00r08         [24]  143 	mov	dptr,#_wcstombs_m_65536_40
      000013 E4               [12]  144 	clr	a
      000014 F0               [24]  145 	movx	@dptr,a
      000015 A3               [24]  146 	inc	dptr
      000016 F0               [24]  147 	movx	@dptr,a
                                    148 ;	wcstombs.c:38: while(n > MB_LEN_MAX || n >= wctomb(buffer, *pwcs))
      000017 90r00r00         [24]  149 	mov	dptr,#_wcstombs_PARM_2
      00001A E0               [24]  150 	movx	a,@dptr
      00001B FD               [12]  151 	mov	r5,a
      00001C A3               [24]  152 	inc	dptr
      00001D E0               [24]  153 	movx	a,@dptr
      00001E FE               [12]  154 	mov	r6,a
      00001F A3               [24]  155 	inc	dptr
      000020 E0               [24]  156 	movx	a,@dptr
      000021 FF               [12]  157 	mov	r7,a
      000022                        158 00107$:
      000022 90r00r03         [24]  159 	mov	dptr,#_wcstombs_PARM_3
      000025 E0               [24]  160 	movx	a,@dptr
      000026 F5*00            [12]  161 	mov	_wcstombs_sloc0_1_0,a
      000028 A3               [24]  162 	inc	dptr
      000029 E0               [24]  163 	movx	a,@dptr
      00002A F5*01            [12]  164 	mov	(_wcstombs_sloc0_1_0 + 1),a
      00002C C3               [12]  165 	clr	c
      00002D 74 04            [12]  166 	mov	a,#0x04
      00002F 95*00            [12]  167 	subb	a,_wcstombs_sloc0_1_0
      000031 E4               [12]  168 	clr	a
      000032 95*01            [12]  169 	subb	a,(_wcstombs_sloc0_1_0 + 1)
      000034 40 52            [24]  170 	jc	00108$
      000036 8D 82            [24]  171 	mov	dpl,r5
      000038 8E 83            [24]  172 	mov	dph,r6
      00003A 8F F0            [24]  173 	mov	b,r7
      00003C 12r00r00         [24]  174 	lcall	__gptrget
      00003F F8               [12]  175 	mov	r0,a
      000040 A3               [24]  176 	inc	dptr
      000041 12r00r00         [24]  177 	lcall	__gptrget
      000044 F9               [12]  178 	mov	r1,a
      000045 A3               [24]  179 	inc	dptr
      000046 12r00r00         [24]  180 	lcall	__gptrget
      000049 FA               [12]  181 	mov	r2,a
      00004A A3               [24]  182 	inc	dptr
      00004B 12r00r00         [24]  183 	lcall	__gptrget
      00004E FC               [12]  184 	mov	r4,a
      00004F 90r00r00         [24]  185 	mov	dptr,#_wctomb_PARM_2
      000052 E8               [12]  186 	mov	a,r0
      000053 F0               [24]  187 	movx	@dptr,a
      000054 E9               [12]  188 	mov	a,r1
      000055 A3               [24]  189 	inc	dptr
      000056 F0               [24]  190 	movx	@dptr,a
      000057 EA               [12]  191 	mov	a,r2
      000058 A3               [24]  192 	inc	dptr
      000059 F0               [24]  193 	movx	@dptr,a
      00005A EC               [12]  194 	mov	a,r4
      00005B A3               [24]  195 	inc	dptr
      00005C F0               [24]  196 	movx	@dptr,a
      00005D 90r00r0A         [24]  197 	mov	dptr,#_wcstombs_buffer_65536_40
      000060 75 F0 00         [24]  198 	mov	b,#0x00
      000063 C0 07            [24]  199 	push	ar7
      000065 C0 06            [24]  200 	push	ar6
      000067 C0 05            [24]  201 	push	ar5
      000069 78r00            [12]  202 	mov	r0,#_wctomb
      00006B 79s00            [12]  203 	mov	r1,#(_wctomb >> 8)
      00006D 7As00            [12]  204 	mov	r2,#(_wctomb >> 16)
      00006F 12r00r00         [24]  205 	lcall	__sdcc_banked_call
      000072 AB 82            [24]  206 	mov	r3,dpl
      000074 AC 83            [24]  207 	mov	r4,dph
      000076 D0 05            [24]  208 	pop	ar5
      000078 D0 06            [24]  209 	pop	ar6
      00007A D0 07            [24]  210 	pop	ar7
      00007C C3               [12]  211 	clr	c
      00007D E5*00            [12]  212 	mov	a,_wcstombs_sloc0_1_0
      00007F 9B               [12]  213 	subb	a,r3
      000080 E5*01            [12]  214 	mov	a,(_wcstombs_sloc0_1_0 + 1)
      000082 9C               [12]  215 	subb	a,r4
      000083 50 03            [24]  216 	jnc	00129$
      000085 02r01r57         [24]  217 	ljmp	00109$
      000088                        218 00129$:
      000088                        219 00108$:
                                    220 ;	wcstombs.c:40: int b = wctomb(s, *pwcs);
      000088 90r00r05         [24]  221 	mov	dptr,#_wcstombs_s_65536_39
      00008B E0               [24]  222 	movx	a,@dptr
      00008C F5*02            [12]  223 	mov	_wcstombs_sloc1_1_0,a
      00008E A3               [24]  224 	inc	dptr
      00008F E0               [24]  225 	movx	a,@dptr
      000090 F5*03            [12]  226 	mov	(_wcstombs_sloc1_1_0 + 1),a
      000092 A3               [24]  227 	inc	dptr
      000093 E0               [24]  228 	movx	a,@dptr
      000094 F5*04            [12]  229 	mov	(_wcstombs_sloc1_1_0 + 2),a
      000096 8D 82            [24]  230 	mov	dpl,r5
      000098 8E 83            [24]  231 	mov	dph,r6
      00009A 8F F0            [24]  232 	mov	b,r7
      00009C 12r00r00         [24]  233 	lcall	__gptrget
      00009F F8               [12]  234 	mov	r0,a
      0000A0 A3               [24]  235 	inc	dptr
      0000A1 12r00r00         [24]  236 	lcall	__gptrget
      0000A4 F9               [12]  237 	mov	r1,a
      0000A5 A3               [24]  238 	inc	dptr
      0000A6 12r00r00         [24]  239 	lcall	__gptrget
      0000A9 FB               [12]  240 	mov	r3,a
      0000AA A3               [24]  241 	inc	dptr
      0000AB 12r00r00         [24]  242 	lcall	__gptrget
      0000AE FC               [12]  243 	mov	r4,a
      0000AF 90r00r00         [24]  244 	mov	dptr,#_wctomb_PARM_2
      0000B2 E8               [12]  245 	mov	a,r0
      0000B3 F0               [24]  246 	movx	@dptr,a
      0000B4 E9               [12]  247 	mov	a,r1
      0000B5 A3               [24]  248 	inc	dptr
      0000B6 F0               [24]  249 	movx	@dptr,a
      0000B7 EB               [12]  250 	mov	a,r3
      0000B8 A3               [24]  251 	inc	dptr
      0000B9 F0               [24]  252 	movx	@dptr,a
      0000BA EC               [12]  253 	mov	a,r4
      0000BB A3               [24]  254 	inc	dptr
      0000BC F0               [24]  255 	movx	@dptr,a
      0000BD 85*02 82         [24]  256 	mov	dpl,_wcstombs_sloc1_1_0
      0000C0 85*03 83         [24]  257 	mov	dph,(_wcstombs_sloc1_1_0 + 1)
      0000C3 85*04 F0         [24]  258 	mov	b,(_wcstombs_sloc1_1_0 + 2)
      0000C6 C0 07            [24]  259 	push	ar7
      0000C8 C0 06            [24]  260 	push	ar6
      0000CA C0 05            [24]  261 	push	ar5
      0000CC 78r00            [12]  262 	mov	r0,#_wctomb
      0000CE 79s00            [12]  263 	mov	r1,#(_wctomb >> 8)
      0000D0 7As00            [12]  264 	mov	r2,#(_wctomb >> 16)
      0000D2 12r00r00         [24]  265 	lcall	__sdcc_banked_call
      0000D5 AB 82            [24]  266 	mov	r3,dpl
      0000D7 AC 83            [24]  267 	mov	r4,dph
      0000D9 D0 05            [24]  268 	pop	ar5
      0000DB D0 06            [24]  269 	pop	ar6
      0000DD D0 07            [24]  270 	pop	ar7
                                    271 ;	wcstombs.c:42: if(b == 1 && !*s)
      0000DF BB 01 19         [24]  272 	cjne	r3,#0x01,00102$
      0000E2 BC 00 16         [24]  273 	cjne	r4,#0x00,00102$
      0000E5 90r00r05         [24]  274 	mov	dptr,#_wcstombs_s_65536_39
      0000E8 E0               [24]  275 	movx	a,@dptr
      0000E9 F8               [12]  276 	mov	r0,a
      0000EA A3               [24]  277 	inc	dptr
      0000EB E0               [24]  278 	movx	a,@dptr
      0000EC F9               [12]  279 	mov	r1,a
      0000ED A3               [24]  280 	inc	dptr
      0000EE E0               [24]  281 	movx	a,@dptr
      0000EF FA               [12]  282 	mov	r2,a
      0000F0 88 82            [24]  283 	mov	dpl,r0
      0000F2 89 83            [24]  284 	mov	dph,r1
      0000F4 8A F0            [24]  285 	mov	b,r2
      0000F6 12r00r00         [24]  286 	lcall	__gptrget
      0000F9 60 5C            [24]  287 	jz	00109$
                                    288 ;	wcstombs.c:43: break;
      0000FB                        289 00102$:
                                    290 ;	wcstombs.c:44: if(b < 0)
      0000FB EC               [12]  291 	mov	a,r4
      0000FC 30 E7 05         [24]  292 	jnb	acc.7,00105$
                                    293 ;	wcstombs.c:45: return(-1);
      0000FF 90 FF FF         [24]  294 	mov	dptr,#0xffff
      000102 80 5F            [24]  295 	sjmp	00110$
      000104                        296 00105$:
                                    297 ;	wcstombs.c:47: n -= b;
      000104 90r00r03         [24]  298 	mov	dptr,#_wcstombs_PARM_3
      000107 E0               [24]  299 	movx	a,@dptr
      000108 F5*02            [12]  300 	mov	_wcstombs_sloc1_1_0,a
      00010A A3               [24]  301 	inc	dptr
      00010B E0               [24]  302 	movx	a,@dptr
      00010C F5*03            [12]  303 	mov	(_wcstombs_sloc1_1_0 + 1),a
      00010E 8B*00            [24]  304 	mov	_wcstombs_sloc0_1_0,r3
      000110 8C*01            [24]  305 	mov	(_wcstombs_sloc0_1_0 + 1),r4
      000112 90r00r03         [24]  306 	mov	dptr,#_wcstombs_PARM_3
      000115 E5*02            [12]  307 	mov	a,_wcstombs_sloc1_1_0
      000117 C3               [12]  308 	clr	c
      000118 95*00            [12]  309 	subb	a,_wcstombs_sloc0_1_0
      00011A F0               [24]  310 	movx	@dptr,a
      00011B E5*03            [12]  311 	mov	a,(_wcstombs_sloc1_1_0 + 1)
      00011D 95*01            [12]  312 	subb	a,(_wcstombs_sloc0_1_0 + 1)
      00011F A3               [24]  313 	inc	dptr
      000120 F0               [24]  314 	movx	@dptr,a
                                    315 ;	wcstombs.c:48: m += b;
      000121 90r00r08         [24]  316 	mov	dptr,#_wcstombs_m_65536_40
      000124 E0               [24]  317 	movx	a,@dptr
      000125 F9               [12]  318 	mov	r1,a
      000126 A3               [24]  319 	inc	dptr
      000127 E0               [24]  320 	movx	a,@dptr
      000128 FA               [12]  321 	mov	r2,a
      000129 90r00r08         [24]  322 	mov	dptr,#_wcstombs_m_65536_40
      00012C E5*00            [12]  323 	mov	a,_wcstombs_sloc0_1_0
      00012E 29               [12]  324 	add	a,r1
      00012F F0               [24]  325 	movx	@dptr,a
      000130 E5*01            [12]  326 	mov	a,(_wcstombs_sloc0_1_0 + 1)
      000132 3A               [12]  327 	addc	a,r2
      000133 A3               [24]  328 	inc	dptr
      000134 F0               [24]  329 	movx	@dptr,a
                                    330 ;	wcstombs.c:49: s += b;
      000135 90r00r05         [24]  331 	mov	dptr,#_wcstombs_s_65536_39
      000138 E0               [24]  332 	movx	a,@dptr
      000139 F8               [12]  333 	mov	r0,a
      00013A A3               [24]  334 	inc	dptr
      00013B E0               [24]  335 	movx	a,@dptr
      00013C F9               [12]  336 	mov	r1,a
      00013D A3               [24]  337 	inc	dptr
      00013E E0               [24]  338 	movx	a,@dptr
      00013F FA               [12]  339 	mov	r2,a
      000140 90r00r05         [24]  340 	mov	dptr,#_wcstombs_s_65536_39
      000143 EB               [12]  341 	mov	a,r3
      000144 28               [12]  342 	add	a,r0
      000145 F0               [24]  343 	movx	@dptr,a
      000146 EC               [12]  344 	mov	a,r4
      000147 39               [12]  345 	addc	a,r1
      000148 A3               [24]  346 	inc	dptr
      000149 F0               [24]  347 	movx	@dptr,a
      00014A EA               [12]  348 	mov	a,r2
      00014B A3               [24]  349 	inc	dptr
      00014C F0               [24]  350 	movx	@dptr,a
                                    351 ;	wcstombs.c:50: pwcs++;
      00014D 74 04            [12]  352 	mov	a,#0x04
      00014F 2D               [12]  353 	add	a,r5
      000150 FD               [12]  354 	mov	r5,a
      000151 E4               [12]  355 	clr	a
      000152 3E               [12]  356 	addc	a,r6
      000153 FE               [12]  357 	mov	r6,a
      000154 02r00r22         [24]  358 	ljmp	00107$
      000157                        359 00109$:
                                    360 ;	wcstombs.c:53: return(m);
      000157 90r00r08         [24]  361 	mov	dptr,#_wcstombs_m_65536_40
      00015A E0               [24]  362 	movx	a,@dptr
      00015B FE               [12]  363 	mov	r6,a
      00015C A3               [24]  364 	inc	dptr
      00015D E0               [24]  365 	movx	a,@dptr
      00015E FF               [12]  366 	mov	r7,a
      00015F 8E 82            [24]  367 	mov	dpl,r6
      000161 8F 83            [24]  368 	mov	dph,r7
      000163                        369 00110$:
                                    370 ;	wcstombs.c:54: }
      000163 02r00r00         [24]  371 	ljmp	__sdcc_banked_ret
                                    372 	.area CSEG    (CODE)
                                    373 	.area CONST   (CODE)
                                    374 	.area XINIT   (CODE)
                                    375 	.area CABS    (ABS,CODE)
